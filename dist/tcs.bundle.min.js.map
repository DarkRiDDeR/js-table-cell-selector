{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/lib/sheetclip.js","webpack:///./src/dom.js","webpack:///./src/actions.js","webpack:///./src/buffer.js","webpack:///./src/funcs.js","webpack:///./src/selector.js","webpack:///./src/table.js","webpack:///./src/app.js"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","global","countQuotes","str","split","length","SheetClip","parse","rlen","rows","clen","multiline","last","arr","pop","substring","replace","indexOf","push","stringify","val","getParentTags","elem","list","tagNames","toLowerCase","map","e","trim","tagName","document","parentNode","isElement","Element","HTMLDocument","getElementsByTagNames","obj","resultArray","Array","tags","getElementsByTagName","j","testNode","sourceIndex","sort","b","compareDocumentPosition","on","addEventListener","element","event","handler","attachEvent","off","removeEventListener","detachEvent","Actions","obSelector","_classCallCheck","this","_defineProperty","table","getTable","c1","c2","undefined","ar","fill","iterateCells","iy","ix","cell","_gOptions","getCellFn","_this","isIgnoredCell","setCellFn","_this2","callbackFn","matrix","sizeMatrix","cells","data","coord","cellVal","mergePastingGlue","countR","countRows","countC","countCols","maxY","maxX","cellFn","y","x","mergeWithCell","Buffer","container","buffer_classCallCheck","buffer_defineProperty","body","initSelectFake","text","_text","fakeElem","select","setSelectionRange","execCommand","err","isRTL","documentElement","getAttribute","createElement","style","fontSize","border","padding","margin","position","yPosition","pageYOffset","scrollTop","top","concat","appendChild","callback","focus","onInput","target","blur","removeChild","isEmpty","addClass","classList","add","hasClass","contains","removeClass","remove","Selector","selector_classCallCheck","selector_defineProperty","initSizeMatrix","selectClass","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","iterator","next","done","isSelectedCell","deselectCell","return","_countCols","_countRows","isArray","parseInt","row","Error","isSelected","loop","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","rowCrest","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","itd","colspan","rowspan","ignoreClass","temp","_this$normalizeCoords2","_slicedToArray","normalizeCoords","_this$getRectangleCoo2","getRectangleCoords","result","selectCell","getCell","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","selectIgnoreClass","Table","obApp","table_classCallCheck","table_defineProperty","onMouseOver","onMouseDown","onMouseEnter","onMouseLeave","onMouseUp","onOutTableClick","selectableTableClass","addEvents","_onMouseOver","_onMouseDown","_onMouseEnter","_onMouseLeave","_onMouseUp","ownerDocument","_onOutTableClick","removeEvents","isRightMB","which","button","preventDefault","isRightMouseBtn","isMouseDown","deselectAll","coords","getSelectedRectangleCoords","_isMouse","deselectOutTableClick","__webpack_exports__","app_TableCellSelector","require","enableChanging","innerText","TableCellSelector","options","buffer","app_classCallCheck","app_defineProperty","onKeyDown","_typeof","assign","obTable","obActions","obBuffer","_onKeyDown","_Buffer","_coords","app_slicedToArray","clear","_coords2","copy","_coords3","cut","destroySizeMatrix","keyCode","ctrl","ctrlKey","isMouse","selectAll","paste","_coords4","_this$obSelector$norm2","_this$obSelector$getR2","deselect","destroy"],"mappings":"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","file":"tcs.bundle.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"../dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/**\n * SheetClip - Spreadsheet Clipboard Parser\n * version 0.2\n *\n * This tiny library transforms JavaScript arrays to strings that are pasteable by LibreOffice, OpenOffice,\n * Google Docs and Microsoft Excel.\n *\n * Copyright 2012, Marcin Warpechowski\n * Licensed under the MIT license.\n * http://github.com/warpech/sheetclip/\n */\n/*jslint white: true*/\n(function (global) {\n    \"use strict\";\n\n    function countQuotes(str) {\n        return str.split('\"').length - 1;\n    }\n\n    global.SheetClip = {\n        parse: function (str) {\n            var r, rlen, rows, arr = [], a = 0, c, clen, multiline, last;\n            rows = str.split('\\n');\n            if (rows.length > 1 && rows[rows.length - 1] === '') {\n                rows.pop();\n            }\n            for (r = 0, rlen = rows.length; r < rlen; r += 1) {\n                rows[r] = rows[r].split('\\t');\n                for (c = 0, clen = rows[r].length; c < clen; c += 1) {\n                    if (!arr[a]) {\n                        arr[a] = [];\n                    }\n                    if (multiline && c === 0) {\n                        last = arr[a].length - 1;\n                        arr[a][last] = arr[a][last] + '\\n' + rows[r][0];\n                        if (multiline && (countQuotes(rows[r][0]) & 1)) { //& 1 is a bitwise way of performing mod 2\n                            multiline = false;\n                            arr[a][last] = arr[a][last].substring(0, arr[a][last].length - 1).replace(/\"\"/g, '\"');\n                        }\n                    }\n                    else {\n                        if (c === clen - 1 && rows[r][c].indexOf('\"') === 0 && (countQuotes(rows[r][c]) & 1)) {\n                            arr[a].push(rows[r][c].substring(1).replace(/\"\"/g, '\"'));\n                            multiline = true;\n                        }\n                        else {\n                            arr[a].push(rows[r][c].replace(/\"\"/g, '\"'));\n                            multiline = false;\n                        }\n                    }\n                }\n                if (!multiline) {\n                    a += 1;\n                }\n            }\n            return arr;\n        },\n\n        stringify: function (arr) {\n            var r, rlen, c, clen, str = '', val;\n            for (r = 0, rlen = arr.length; r < rlen; r += 1) {\n                for (c = 0, clen = arr[r].length; c < clen; c += 1) {\n                    if (c > 0) {\n                        str += '\\t';\n                    }\n                    val = arr[r][c];\n                    if (typeof val === 'string') {\n                        if (val.indexOf('\\n') > -1) {\n                            str += '\"' + val.replace(/\"/g, '\"\"') + '\"';\n                        }\n                        else {\n                            str += val;\n                        }\n                    }\n                    else if (val === null || val === void 0) { //void 0 resolves to undefined\n                        str += '';\n                    }\n                    else {\n                        str += val;\n                    }\n                }\n                str += '\\n';\n            }\n            return str;\n        }\n    };\n}(window));","export const getParentTags = function (elem, list) {\r\n    let tagNames = list\r\n        .toLowerCase()\r\n        .split(',')\r\n        .map(function (e) {\r\n            return e.trim();\r\n        });\r\n    if (tagNames.indexOf(elem.tagName.toLowerCase()) > -1) return elem;\r\n    for ( ; elem && elem !== document; elem = elem.parentNode ) {\r\n        if (tagNames.indexOf( elem.tagName.toLowerCase()) > -1) return elem;\r\n    }\r\n    return null;\r\n};\r\n\r\nexport const isElement = function(elem) {\r\n    return elem instanceof Element || elem instanceof HTMLDocument;\r\n};\r\n\r\n/**\r\n * get elements by tag names. Function: getElementsByTagNames(list [,obj])\r\n * @param list of tag names. Example \"td, th\"\r\n * @param obj - parent element\r\n * @returns array elements\r\n */\r\nexport const getElementsByTagNames = function(list, obj) {\r\n    if (!obj) obj = document;\r\n    let tagNames = list.split(',');\r\n    let resultArray = new Array();\r\n    for (let i=0;i<tagNames.length;i++) {\r\n        let tags = obj.getElementsByTagName(tagNames[i].trim());\r\n        for (let j=0;j<tags.length;j++) {\r\n            resultArray.push(tags[j]);\r\n        }\r\n    }\r\n    let testNode = resultArray[0];\r\n    if (!testNode) return [];\r\n    if (testNode.sourceIndex) {\r\n        resultArray.sort(function (a,b) {\r\n            return a.sourceIndex - b.sourceIndex;\r\n        });\r\n    }\r\n    else if (testNode.compareDocumentPosition) {\r\n        resultArray.sort(function (a,b) {\r\n            return 3 - (a.compareDocumentPosition(b) & 6);\r\n        });\r\n    }\r\n    return resultArray;\r\n};\r\n\r\nexport const on = (function() {\r\n    if (document.addEventListener) {\r\n        return function(element, event, handler) {\r\n            if (element && event && handler) {\r\n                element.addEventListener(event, handler, false);\r\n            }\r\n        };\r\n    } else {\r\n        return function(element, event, handler) {\r\n            if (element && event && handler) {\r\n                element.attachEvent('on' + event, handler);\r\n            }\r\n        };\r\n    }\r\n})();\r\n\r\nexport const off = (function() {\r\n    if (document.removeEventListener) {\r\n        return function(element, event, handler) {\r\n            if (element && event) {\r\n                element.removeEventListener(event, handler, false);\r\n            }\r\n        };\r\n    } else {\r\n        return function(element, event, handler) {\r\n            if (element && event) {\r\n                element.detachEvent('on' + event, handler);\r\n            }\r\n        };\r\n    }\r\n})();\r\n\r\n","import {_gOptions} from \"./app\";\r\nimport {getElementsByTagNames} from \"./dom\";\r\n\r\nexport default class Actions {\r\n    obSelector;\r\n    table;\r\n\r\n    constructor (obSelector) {\r\n        this.obSelector = obSelector;\r\n        this.table = this.obSelector.getTable();\r\n    }\r\n\r\n    /**\r\n     * Function: copy (c1 [, c2])\r\n     * @param c1\r\n     * @param c2\r\n     * @returns {array[][]}\r\n     */\r\n    copy (c1, c2) {\r\n        if (c2 === undefined) c2 = c1;\r\n        let ar = Array(c2[0] - c1[0] + 1 ).fill().map(\r\n            () => Array(c2[1] - c1[1] + 1 )\r\n        );\r\n\r\n        this.iterateCells(c1, c2, (iy, ix, cell) => {\r\n            ar[iy-c1[0]][ix-c1[1]] = _gOptions.getCellFn(cell, [iy, ix]);\r\n        });\r\n        return ar;\r\n    }\r\n\r\n    /**\r\n     * Function: clear (c1 [, c2])\r\n     * @param c1\r\n     * @param c2\r\n     */\r\n    clear (c1, c2) {\r\n        if (c2 === undefined) c2 = c1;\r\n        this.iterateCells(c1, c2, (iy, ix, cell) => {\r\n            if (!this.obSelector.isIgnoredCell(cell)) {\r\n                _gOptions.setCellFn(cell, \"\", [iy, ix]);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Function: cut (c1 [, c2])\r\n     * @param c1\r\n     * @param c2\r\n     * @returns {array[][]}\r\n     */\r\n    cut (c1, c2) {\r\n        if (c2 === undefined) c2 = c1;\r\n        let ar = Array(c2[0] - c1[0] + 1 ).fill().map(\r\n            () => Array(c2[1] - c1[1] + 1 )\r\n        );\r\n        this.iterateCells(c1, c2, (iy, ix, cell) => {\r\n            ar[iy-c1[0]][ix-c1[1]] = _gOptions.getCellFn(cell, [iy, ix]);\r\n            if (!this.obSelector.isIgnoredCell(cell)) {\r\n                _gOptions.setCellFn(cell, \"\", [iy, ix]);\r\n            }\r\n        });\r\n        return ar;\r\n    }\r\n\r\n    iterateCells (c1, c2, callbackFn) {\r\n        const matrix = this.obSelector.sizeMatrix;\r\n        let rows = this.table.getElementsByTagName(\"tr\");\r\n        for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n            let cells = getElementsByTagNames(\"td,th\", rows[iy]);\r\n            for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                if (!(matrix[iy][ix][0] < 0) && !(matrix[iy][ix][1] < 0)) {\r\n                    callbackFn(iy, ix, cells[matrix[iy][ix][2]]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    mergeWithCell (cell, data, coord) {\r\n        let cellVal = _gOptions.getCellFn(cell, coord).trim();\r\n        if (cellVal === \"\") cellVal = data;\r\n        else if (data !== \"\") cellVal += _gOptions.mergePastingGlue + data;\r\n        _gOptions.setCellFn(cell, cellVal, coord);\r\n    }\r\n\r\n    paste (data, c1, c2) {\r\n        const matrix = this.obSelector.sizeMatrix;\r\n        const rows = this.table.getElementsByTagName(\"tr\");\r\n        const countR = this.obSelector.countRows;\r\n        const countC = this.obSelector.countCols;\r\n\r\n        let maxY = c1[0] + data.length;\r\n        if (maxY > countR) maxY = countR;\r\n        if (maxY > c2[0]) maxY = c2[0]+1;\r\n\r\n        for (let iy = c1[0]; iy < maxY; iy++) {\r\n            let maxX = c1[1] + data[iy-c1[0]].length;\r\n            if (maxX > countC) maxX = countC;\r\n            if (maxX > c2[1]) maxX = c2[1]+1;\r\n\r\n            let cellFn;\r\n            for (let ix = c1[1]; ix < maxX; ix++) {\r\n                let y = iy;\r\n                let x = ix;\r\n                if (matrix[iy][ix][1] < 0 || matrix[iy][ix][0] < 0) {\r\n                    if (matrix[iy][ix][0] < 0) y += matrix[iy][ix][0];\r\n                    if (matrix[iy][ix][1] < 0) x += matrix[iy][ix][1];\r\n                    cellFn = this.mergeWithCell;\r\n                } else {\r\n                    cellFn = _gOptions.setCellFn;\r\n                }\r\n\r\n                let cell = getElementsByTagNames(\"td,th\", rows[y])[matrix[y][x][2]];\r\n                if (!this.obSelector.isIgnoredCell(cell)) {\r\n                    cellFn(cell, data[iy - c1[0]][ix - c1[1]], [y, x]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","import {on, off, isElement} from \"./dom\";\r\n\r\nexport default class Buffer {\r\n    fakeElem;\r\n    _text;\r\n\r\n    constructor (container) {\r\n        this.container = isElement(container) ? container : document.body;\r\n        this.initSelectFake();\r\n    }\r\n\r\n    /**\r\n     * Executes the copy operation based on the current selection.\r\n     */\r\n    copy(text) {\r\n        try {\r\n            this._text = text;\r\n            this.fakeElem.value = text;\r\n            this.fakeElem.select();\r\n            this.fakeElem.setSelectionRange(0, text.length);\r\n            return document.execCommand(\"cut\");\r\n        }\r\n        catch (err) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a fake textarea element, sets its value from `text` property,\r\n     * and makes a selection on it.\r\n     */\r\n    initSelectFake() {\r\n        const isRTL = document.documentElement.getAttribute('dir') == 'rtl';\r\n\r\n        this.fakeElem = document.createElement('textarea');\r\n        // Prevent zooming on iOS\r\n        this.fakeElem.style.fontSize = '12pt';\r\n        // Reset box model\r\n        this.fakeElem.style.border = '0';\r\n        this.fakeElem.style.padding = '0';\r\n        this.fakeElem.style.margin = '0';\r\n        // Move element out of screen horizontally\r\n        this.fakeElem.style.position = 'absolute';\r\n        this.fakeElem.style[ isRTL ? 'right' : 'left' ] = '-9999px';\r\n        // Move element to the same position vertically\r\n        let yPosition = window.pageYOffset || document.documentElement.scrollTop;\r\n        this.fakeElem.style.top = `${yPosition}px`;\r\n\r\n        this.container.appendChild(this.fakeElem);\r\n    }\r\n\r\n    /**\r\n     * Can only be called when the combination is pressed Ctrl + V\r\n     * @returns {string}\r\n     */\r\n    paste (callback) {\r\n        this.fakeElem.value = \"\";\r\n        this.fakeElem.focus();\r\n        let onInput = (e) => {\r\n            this._text = e.target.value;\r\n            this.fakeElem.blur();\r\n            off(this.fakeElem, \"input\", onInput);\r\n            callback(this._text);\r\n        };\r\n        on(this.fakeElem, \"input\", onInput);\r\n    }\r\n\r\n    get text () {\r\n        return this._text;\r\n    }\r\n\r\n    destroy() {\r\n        if (this.fakeElem) {\r\n            this.container.removeChild(this.fakeElem);\r\n            this.fakeElem = null;\r\n        }\r\n    }\r\n}","export const isEmpty = function(value){\r\n    return (value == null || value.length === 0);\r\n};\r\n\r\nexport const addClass = function(elem, name){\r\n    elem.classList.add(name);\r\n};\r\nexport const hasClass = function(elem, name){\r\n    return elem.classList.contains(name);\r\n};\r\nexport const removeClass = function(elem, name){\r\n    elem.classList.remove(name);\r\n};\r\n","import {_gOptions} from \"./app\";\r\nimport {getElementsByTagNames} from \"./dom\";\r\nimport {isEmpty, addClass, hasClass, removeClass} from \"./funcs\";\r\n\r\nexport default class Selector {\r\n    _countCols = 0;\r\n    _countRows = 0;\r\n    matrix;\r\n    table;\r\n\r\n    constructor (table) {\r\n        this.table = table;\r\n        /*if (_gOptions.usingSizeMatrix) */ this.initSizeMatrix();\r\n    }\r\n\r\n    deselectCell(cell) {\r\n        removeClass(cell, _gOptions.selectClass);\r\n    }\r\n\r\n    deselectAll() {\r\n        let length = 0;\r\n        let list = getElementsByTagNames(\"td,th\", this.table);\r\n\r\n        for (let cell of list) {\r\n            if (this.isSelectedCell(cell)) {\r\n                this.deselectCell(cell);\r\n                length++;\r\n            }\r\n        }\r\n        return length;\r\n    }\r\n\r\n    destroySizeMatrix() {\r\n        this._countCols = undefined;\r\n        this._countRows = undefined;\r\n        this.matrix = undefined;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param c - coordinate cell. Example [0, 0]\r\n     */\r\n    getCell (c) {\r\n        if (Array.isArray(c) ) {\r\n            // normalize\r\n            c[0] = parseInt(c[0]) || 0;\r\n            c[1] = parseInt(c[1]) || 0;\r\n\r\n            if (c[0] >= 0 && c[1] >= 0) {\r\n                //if (_gOptions.usingSizeMatrix) {\r\n                if (c[0] < this.countRows && c[1] < this.countCols) {\r\n                    if (this.matrix[c[0]][c[1]][0] < 0) c[0] += this.matrix[c[0]][c[1]][0];\r\n                    if (this.matrix[c[0]][c[1]][1] < 0) c[1] += this.matrix[c[0]][c[1]][1];\r\n\r\n                    let row = this.table.getElementsByTagName(\"tr\")[c[0]];\r\n                    return getElementsByTagNames(\"td,th\", row)[this.matrix[c[0]][c[1]][2]];\r\n                }\r\n                /*} else {\r\n                    let rows = this.table.getElementsByTagName(\"tr\");\r\n                    for (let iy = 0; iy < rows.length; iy++) {\r\n                        if (c[0] != iy) continue;\r\n                        let cols = rows[iy].getElementsByTagName(\"td\");\r\n                        for (let ix = 0; ix < cols.length; ix++) {\r\n                            if (c[1] != ix) continue;\r\n                            return cols[ix];\r\n                        }\r\n                    }\r\n                }*/\r\n            }\r\n            return null;\r\n        } else {\r\n            throw new Error(\"Invalid coordinate\");\r\n        }\r\n    }\r\n\r\n    get countCols () {\r\n        return this._countCols;\r\n    }\r\n\r\n    get countRows () {\r\n        return this._countRows;\r\n    }\r\n\r\n    /**\r\n     * get coords of selected cells\r\n     * @returns array [[0, 0], [1, 1]] or false\r\n     */\r\n    getSelectedRectangleCoords () {\r\n        let isSelected = false;\r\n        let c1 = Array(2);\r\n        let c2 = Array(2);\r\n\r\n        //if (_gOptions.usingSizeMatrix) {\r\n        // get extreme points\r\n        let rows = this.table.getElementsByTagName(\"tr\");\r\n        for (let iy = 0; iy < this.countRows; iy++) {\r\n            let cells = getElementsByTagNames(\"td,th\", rows[iy]);\r\n            for (let ix = 0; ix < this.countCols; ix++) {\r\n                if (\r\n                    !(this.matrix[iy][ix][0] < 0)\r\n                    && !(this.matrix[iy][ix][1] < 0)\r\n                    && this.isSelectedCell(cells[this.matrix[iy][ix][2]])\r\n                ) {\r\n                    isSelected = true;\r\n\r\n                    if (c1[0] === undefined || c1[0] > iy) c1[0] = iy;\r\n                    if (c1[1] === undefined || c1[1] > ix) c1[1] = ix;\r\n\r\n                    if (c2[0] === undefined || c2[0] < iy) c2[0] = iy;\r\n                    if (c2[1] === undefined || c2[1] < ix) c2[1] = ix;\r\n                }\r\n            }\r\n        }\r\n        /*} else {\r\n            let rows = this.table.getElementsByTagName(\"tr\");\r\n            for (let iy = 0; iy < rows.length; iy++) {\r\n                let cols = rows[iy].getElementsByTagName(\"td\");\r\n                for (let ix = 0; ix < cols.length; ix++) {\r\n                    if(this.isSelectedCell(cols[ix]))\r\n                    {\r\n                        isSelected = true;\r\n\r\n                        if (c1[0] === undefined || iy < c1[0]) c1[0] = iy;\r\n                        if (c2[0] === undefined || iy > c2[0]) c2[0] = iy;\r\n\r\n                        if (c1[1] === undefined || ix < c1[1]) c1[1] = ix;\r\n                        if (c2[1] === undefined || ix > c2[1]) c2[1] = ix;\r\n                    }\r\n                }\r\n            }\r\n        }*/\r\n        return isSelected ? [c1, c2] : false;\r\n    }\r\n\r\n    get sizeMatrix () {\r\n        return this.matrix;\r\n    }\r\n\r\n    getRectangleCoords (c1, c2) {\r\n        // magic ))\r\n        let loop = true;\r\n        while(loop) {\r\n            loop = false;\r\n\r\n            // min y\r\n            for (let iy = c1[0]; iy <= c1[0]; iy++) {\r\n                for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                    if (this.matrix[iy][ix][0] !== undefined && this.matrix[iy][ix][0] < 0) {\r\n                        c1[0] += this.matrix[iy][ix][0];\r\n                        iy += this.matrix[iy][ix][0] - 1;\r\n                        loop = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // max y\r\n            for (let iy = c2[0]; iy <= c2[0]; iy++) {\r\n                if ((c2[0] + 1) == this.countRows ) continue;\r\n                for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                    if (this.matrix[iy][ix][0] !== undefined && this.matrix[iy + 1][ix][0] < 0) {\r\n                        c2[0]++;\r\n                        loop = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // min x\r\n            for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n                if (this.matrix[iy][c1[1]][1] < 0) {\r\n                    c1[1] += this.matrix[iy][c1[1]][1];\r\n                    iy = c1[0] - 1;\r\n                    loop = true;\r\n                    // break;\r\n                }\r\n            }\r\n\r\n            // max x\r\n            for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n                if ((c2[1] + 1) == this.countCols) continue;\r\n                if (this.matrix[iy][c2[1]+1][1] < 0) {\r\n                    c2[1]++;\r\n                    iy = c1[0] - 1;\r\n                    loop = true;\r\n                    // break;\r\n                }\r\n            }\r\n        }\r\n        return [c1, c2];\r\n    }\r\n\r\n    getTable () {\r\n        return this.table;\r\n    }\r\n\r\n    initSizeMatrix () {\r\n        let rows = this.table.getElementsByTagName(\"tr\");\r\n        this._countRows = rows.length;\r\n        this._countCols = 0;\r\n\r\n        for (let row of rows) {\r\n            let length = getElementsByTagNames(\"td, th\", row).length;\r\n            if (length > this.countCols) {\r\n                this._countCols = length;\r\n            }\r\n        }\r\n\r\n        this.matrix = Array(this.countRows).fill().map(\r\n            () => Array(this.countCols).fill().map(\r\n                () => Array(2)\r\n            )\r\n        );\r\n        let rowCrest = new Array(this.countCols).fill(0);\r\n\r\n        let iy = 0;\r\n        for (let row of rows) {\r\n            let ix = 0;\r\n            let cells = getElementsByTagNames(\"td, th\", row);\r\n\r\n            for (let itd = 0; itd < cells.length; itd++) {\r\n                const cell = cells[itd];\r\n                let colspan = cell.getAttribute(\"colspan\");\r\n                let rowspan = cell.getAttribute(\"rowspan\");\r\n                if (rowspan > 1) this.matrix[iy][ix][0] = 0;\r\n                if (colspan > 1) this.matrix[iy][ix][1] = 0;\r\n\r\n                while (ix < this.countCols && rowCrest[ix]) {\r\n                    rowCrest[ix]--;\r\n                    this.matrix[iy][ix][0] = this.matrix[iy-1][ix][0] || 0 - 1;\r\n                    this.matrix[iy][ix][1] = this.matrix[iy-1][ix][1];\r\n                    ix++;\r\n                }\r\n\r\n                if (colspan > 1) {\r\n                    this.matrix[iy][ix][2] = itd;\r\n                    for (let i = 0; i > -colspan; i--) {\r\n                        this.matrix[iy][ix][1] = i;\r\n                        if (rowspan > 1) rowCrest[ix] = rowspan - 1;\r\n                        ix++;\r\n                    }\r\n                } else {\r\n                    this.matrix[iy][ix][2] = itd;\r\n                    if (rowspan > 1) rowCrest[ix] = rowspan - 1;\r\n                    ix++;\r\n                }\r\n            }\r\n            iy++;\r\n        }\r\n    }\r\n\r\n    isIgnoredCell(cell) {\r\n        return hasClass(cell, _gOptions.ignoreClass) // td\r\n            || hasClass(cell.parentNode, _gOptions.ignoreClass) // tr\r\n            || hasClass(cell.parentNode.parentNode, _gOptions.ignoreClass); // example thead or tfoot\r\n    }\r\n\r\n    isSelectedCell(cell) {\r\n        return hasClass(cell, _gOptions.selectClass);\r\n    }\r\n\r\n    normalizeCoords (c1, c2) {\r\n        // normalize\r\n        c1[0] = parseInt(c1[0]) || 0;\r\n        c1[1] = parseInt(c1[1]) || 0;\r\n        c2[0] = parseInt(c2[0]) || 0;\r\n        c2[1] = parseInt(c2[1]) || 0;\r\n        let temp;\r\n        if (c1[0] > c2[0]) {\r\n            temp = c2[0];\r\n            c2[0] = c1[0];\r\n            c1[0] = temp;\r\n        }\r\n        if (c1[1] > c2[1]) {\r\n            temp = c2[1];\r\n            c2[1] = c1[1];\r\n            c1[1] = temp;\r\n        }\r\n        return [c1, c2];\r\n    }\r\n\r\n    /**\r\n     * select cells. Fn: select (c1 [, c2])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {boolean}\r\n     */\r\n    select (c1, c2)\r\n    {\r\n        if (Array.isArray(c1) && (Array.isArray(c2) || c2 === undefined)) {\r\n\r\n            if (c2 === undefined || (c1[0] == c2[0] && c1[1] == c2[1])) {\r\n                // normalize\r\n                let cell = this.getCell(c1);\r\n                if (!isEmpty(cell)) {\r\n                    return this.selectCell(cell);\r\n                }\r\n            } else {\r\n                let isSelected = false;\r\n                [c1, c2] = this.normalizeCoords(c1, c2);\r\n\r\n                //if (_gOptions.usingSizeMatrix) {\r\n                if (c1[0] >= this.countRows || c1[1] >= this.countCols || c2[0] < 0 || c2[1] < 0) return false;\r\n                if (c1[0] < 0) c1[0] = 0;\r\n                if (c1[1] < 0) c1[1] = 0;\r\n                if (c2[0] >= this.countRows) c2[0] = this.countRows - 1;\r\n                if (c2[1] >= this.countCols) c2[1] = this.countCols - 1;\r\n\r\n                [c1, c2] = this.getRectangleCoords(c1, c2);\r\n\r\n                let rows = this.table.getElementsByTagName(\"tr\");\r\n                for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n                    let cells = getElementsByTagNames(\"td, th\", rows[iy]);\r\n                    for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                        if (!(this.matrix[iy][ix][0] < 0) && !(this.matrix[iy][ix][1] < 0)) {\r\n                            let result = this.selectCell(cells[this.matrix[iy][ix][2]]);\r\n                            if (!isSelected) isSelected = result;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                /*} else {\r\n\r\n                    let rows = this.table.getElementsByTagName(\"tr\");\r\n                    for (let iy = 0; iy < rows.length; iy++) {\r\n                        if (iy < c1[0] || iy > c2[0]) continue;\r\n                        let cols = rows[iy].getElementsByTagName(\"td\");\r\n                        for (let ix = 0; ix < cols.length; ix++) {\r\n                            if (ix < c1[1] || ix > c2[1]) continue;\r\n                            let result = this.selectCell(cols[ix]);\r\n                            if (!isSelected) isSelected = result;\r\n                        }\r\n                    }\r\n                }*/\r\n                return isSelected;\r\n            }\r\n\r\n            return false;\r\n        } else {\r\n            throw new Error(\"Invalid selection positions\");\r\n        }\r\n    }\r\n\r\n    selectAll () {\r\n        let length = 0;\r\n        let list = getElementsByTagNames(\"td, th\", this.table);\r\n        for (let cell of list) {\r\n            if (this.selectCell(cell)) {\r\n                length++;\r\n            }\r\n        }\r\n        return length;\r\n    }\r\n\r\n    selectCell(cell) {\r\n        if (_gOptions.selectIgnoreClass || !this.isIgnoredCell(cell)) {\r\n            addClass(cell, _gOptions.selectClass);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}","import {_gOptions} from \"./app\";\r\nimport {getParentTags, isElement, on, off} from \"./dom\";\r\nimport {addClass, removeClass} from \"./funcs\";\r\n\r\nexport default class Table {\r\n    isMouseDown = false; // whether the left mouse button is pressed\r\n    obApp;\r\n    obSelector;\r\n    table; // html table\r\n    _isMouse = false;\r\n    _onMouseOver = (e) => this.onMouseOver(e);\r\n    _onMouseDown = (e) => this.onMouseDown(e);\r\n    _onMouseEnter = (e) => this.onMouseEnter(e);\r\n    _onMouseLeave = (e) => this.onMouseLeave(e);\r\n    _onMouseUp = (e) => this.onMouseUp(e);\r\n    _onOutTableClick = (e) => this.onOutTableClick(e);\r\n\r\n    constructor(table, obSelector, obApp) {\r\n        if (isElement(table) && table.tagName === \"TABLE\") {\r\n            this.table = table; // DOM element table\r\n            this.obApp = obApp;\r\n            this.obSelector = obSelector;\r\n            addClass(this.table, _gOptions.selectableTableClass);\r\n            this.addEvents();\r\n        } else {\r\n            throw new Error(\"Мodule must be initialized to Table\");\r\n        }\r\n    }\r\n\r\n    addEvents() {\r\n        on(this.table, \"mouseover\", this._onMouseOver);\r\n        on(this.table, \"mousedown\", this._onMouseDown);\r\n        on(this.table, \"mouseenter\", this._onMouseEnter);\r\n        on(this.table, \"mouseleave\", this._onMouseLeave);\r\n        on(this.table, \"mouseup\", this._onMouseUp);\r\n        on(this.table.ownerDocument, \"click\", this._onOutTableClick); // click outside the table\r\n    }\r\n\r\n    destroy() {\r\n        removeClass(this.table, _gOptions.selectableTableClass);\r\n        this.removeEvents();\r\n    }\r\n\r\n    get isMouse () {\r\n        return this._isMouse;\r\n    }\r\n\r\n    isRightMouseBtn(e) {\r\n        let isRightMB;\r\n        e = e || window.event;\r\n\r\n        if (\"which\" in e)  // Gecko (Firefox), WebKit (Safari/Chrome) & Opera\r\n            isRightMB = e.which == 3;\r\n        else if (\"button\" in e)  // IE, Opera\r\n            isRightMB = e.button == 2;\r\n\r\n        return isRightMB;\r\n    }\r\n\r\n    onMouseDown(e) {\r\n        e.preventDefault();\r\n        if (this.isRightMouseBtn(e)) return true;\r\n\r\n        let cell = getParentTags(e.target, \"td,th\");\r\n        if (cell === null) return; // not for cell\r\n\r\n        this.isMouseDown = true;\r\n\r\n        this.obSelector.deselectAll();\r\n        this.obSelector.selectCell(cell);\r\n    }\r\n\r\n    onMouseOver(e) {\r\n        if (!this.isMouseDown) return false;\r\n\r\n        let cell = getParentTags(e.target, \"td,th\");\r\n        if (cell === null) return; // not for cell\r\n\r\n        this.obSelector.selectCell(cell);\r\n        //magic selection\r\n        let coords = this.obSelector.getSelectedRectangleCoords();\r\n        if (coords !== false) this.obSelector.select(coords[0], coords[1]);\r\n    }\r\n\r\n    onMouseEnter (e) {\r\n        this._isMouse = true;\r\n    }\r\n\r\n    onMouseLeave (e) {\r\n        this._isMouse = false;\r\n    }\r\n\r\n    onMouseUp(e) {\r\n        this.isMouseDown = false;\r\n    }\r\n\r\n    onOutTableClick(e) {\r\n        this.isMouseDown = false;\r\n        if (_gOptions.deselectOutTableClick && !getParentTags(e.target, \"table\")) {\r\n            this.obSelector.deselectAll();\r\n        }\r\n    }\r\n\r\n    removeEvents() {\r\n        off(this.table, \"mouseover\", this._onMouseOver);\r\n        off(this.table, \"mousedown\", this._onMouseDown);\r\n        off(this.table, \"mouseenter\", this._onMouseEnter);\r\n        off(this.table, \"mouseleave\", this._onMouseLeave);\r\n        off(this.table, \"mouseup\", this._onMouseUp);\r\n        off(this.table.ownerDocument, \"click\", this._onOutTableClick);\r\n    }\r\n}","\"use strict\";\r\n\r\nimport Actions from \"./actions\";\r\nimport _Buffer from \"./buffer\";\r\nimport {isEmpty} from \"./funcs\";\r\nimport Selector from \"./selector\";\r\nimport Table from \"./table\";\r\nimport {off, on} from \"./dom\";\r\nrequire(\"./lib/sheetclip.js\");\r\n\r\nexport let _gOptions = {\r\n    deselectOutTableClick: true,\r\n    enableChanging: false,\r\n    getCellFn: function (cell, coord) {\r\n        return cell.innerText;\r\n    },\r\n    ignoreClass: 'tcs-ignore',\r\n    //TODO: mergePasting: true,\r\n    mergePastingGlue: ' ',\r\n    selectableTableClass : 'tcs',// class added to table\r\n    selectIgnoreClass: true,\r\n    selectClass: 'tcs-select',\r\n    setCellFn: function (cell, data, coord) {\r\n        cell.innerText = data;\r\n    }\r\n    //frozen option:  usingSizeMatrix: true, // !!! for tables with merged cells, enabling is mandatory. Shutdown optimizes performance for simple tables.\r\n};\r\n\r\nexport default class TableCellSelector {\r\n    obActions;\r\n    obBuffer;\r\n    obSelector;\r\n    obTable;\r\n    _onKeyDown = (e) => this.onKeyDown(e);\r\n\r\n    constructor (table, options, buffer) {\r\n        if (typeof options === \"object\") Object.assign(_gOptions, options);\r\n        this.obSelector = new Selector(table);\r\n        this.obTable = new Table(table, this.obSelector, this);\r\n        this.obActions = new Actions(this.obSelector);\r\n        this.obBuffer = buffer;\r\n        on(document.body, \"keydown\", this._onKeyDown);\r\n    }\r\n\r\n    static get Buffer () {\r\n        return _Buffer;\r\n    }\r\n\r\n    /**\r\n     * clear ([c1 [, c2]])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {boolean}\r\n     */\r\n    clear (c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (coords === false) return false;\r\n            [c1, c2] = coords;\r\n        }\r\n        this.obActions.clear(c1, c2);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * copy ([c1 [, c2]])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {array[][] | false}\r\n     */\r\n    copy (c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (coords === false) return false;\r\n            [c1, c2] = coords;\r\n        }\r\n        const data = this.obActions.copy(c1, c2);\r\n        if (this.obBuffer instanceof _Buffer &&  data !== false) {\r\n            let str = window.SheetClip.stringify(data);\r\n            this.obBuffer.copy(str);\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * cut ([c1 [, c2]])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {array[][] | false}\r\n     */\r\n    cut (c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (isEmpty(coords)) return false;\r\n            [c1, c2] = coords;\r\n        }\r\n        const data = this.obActions.cut(c1, c2);\r\n        if (this.obBuffer instanceof _Buffer && data !== false) {\r\n            let str = window.SheetClip.stringify(data);\r\n            this.obBuffer.copy(str);\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {number}\r\n     */\r\n    deselect () {\r\n        return this.obSelector.deselectAll();\r\n    }\r\n\r\n    /**\r\n     * destroy size matrix for big table or changing tables\r\n     */\r\n    destroySizeMatrix () {\r\n        this.obSelector.destroySizeMatrix();\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {array[] | false}\r\n     */\r\n    getCoords () {\r\n        return this.obSelector.getSelectedRectangleCoords();\r\n    }\r\n\r\n    initSizeMatrix () {\r\n        this.obSelector.initSizeMatrix();\r\n    }\r\n\r\n    onKeyDown (e) {\r\n        e = e || window.event;\r\n        var key = e.which || e.keyCode; // keyCode detection\r\n        var ctrl = e.ctrlKey ? e.ctrlKey : (key === 17); // ctrl detection\r\n\r\n        if (this.obTable.isMouse && ctrl) {\r\n            switch (key) {\r\n            case 65: // a\r\n                e.preventDefault();\r\n                this.selectAll();\r\n                break;\r\n            case 67: // c\r\n                this.copy();\r\n                break;\r\n            case 86: // v\r\n                if (!_gOptions.enableChanging) break;\r\n                if (this.obBuffer instanceof _Buffer) {\r\n                    this.obBuffer.paste((str) => {\r\n                        this.paste(window.SheetClip.parse(str));\r\n                    });\r\n                }\r\n                break;\r\n            case 88: // x\r\n                if (!_gOptions.enableChanging) break;\r\n                this.cut();\r\n                break;\r\n            case 46: // delete\r\n            case 8: // backspase\r\n                if (!_gOptions.enableChanging) break;\r\n                this.clear();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * paste (data [, c1 [, c2]])\r\n     * @param data - array[][]\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     */\r\n    paste (data, c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (isEmpty(coords)) return false;\r\n            [c1, c2] = coords;\r\n        } else if (c2 === undefined) {\r\n            c2 = c1;\r\n        } else {\r\n            [c1, c2] = this.obSelector.normalizeCoords(c1, c2);\r\n        }\r\n        [c1, c2] = this.obSelector.getRectangleCoords(c1, c2);\r\n        this.obActions.paste(data, c1, c2);\r\n    }\r\n\r\n    /**\r\n     * select (c1 [, c2])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {boolean}\r\n     */\r\n    select (c1, c2) {\r\n        this.obSelector.deselectAll();\r\n        return this.obSelector.select(c1, c2);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {number}\r\n     */\r\n    selectAll () {\r\n        return this.obSelector.selectAll();\r\n    }\r\n\r\n    destroy () {\r\n        off(document.body, \"keydown\", this._onKeyDown);\r\n        this.deselect();\r\n        this.obBuffer.destroy();\r\n        this.obTable.destroy();\r\n\r\n        delete\r\n        this.obActions,\r\n        this.obBuffer,\r\n        this.obSelector,\r\n        this.obTable,\r\n        this;\r\n    }\r\n}\r\n\r\nif (typeof window === \"object\") {\r\n    window.TableCellSelector = TableCellSelector;\r\n}\r\n"],"sourceRoot":""}