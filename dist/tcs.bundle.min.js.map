{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/dom.js","webpack:///./src/app.js","webpack:///./src/funcs.js","webpack:///./src/buffer.js","webpack:///./src/lib/sheetclip.js","webpack:///./src/actions.js","webpack:///./src/selector.js","webpack:///./src/table.js","webpack:///(webpack)/buildin/global.js"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","getParentTags","isElement","getElementsByTagNames","on","off","elem","list","tagNames","toLowerCase","split","map","e","trim","indexOf","tagName","document","parentNode","Element","HTMLDocument","obj","resultArray","Array","length","tags","getElementsByTagName","j","push","testNode","sourceIndex","sort","b","compareDocumentPosition","addEventListener","element","event","handler","attachEvent","removeEventListener","detachEvent","global","_gOptions","TableCellSelector","_actions__WEBPACK_IMPORTED_MODULE_0__","_buffer__WEBPACK_IMPORTED_MODULE_1__","_funcs__WEBPACK_IMPORTED_MODULE_2__","_selector__WEBPACK_IMPORTED_MODULE_3__","_table__WEBPACK_IMPORTED_MODULE_4__","_dom__WEBPACK_IMPORTED_MODULE_5__","_lib_sheetclip__WEBPACK_IMPORTED_MODULE_6__","deselectOutTableClick","enableChanging","getCellFn","cell","coord","innerText","ignoreClass","ignoreTfoot","ignoreThead","initHotkeys","mergePastingGlue","mouseBlockSelection","onStartSelect","onFinishSelect","selectIgnoreClass","selectClass","setCellFn","data","tableClass","table","options","buffer","_this","this","_classCallCheck","_defineProperty","onKeyDown","_typeof","_extends","obSelector","Selector","obTable","Table","obActions","Actions","obBuffer","body","_onKeyDown","_Buffer","c1","c2","undefined","coords","getSelectedRectangleCoords","_coords","_slicedToArray","_this$normalizeCoords2","normalizeCoords","clear","_coords2","_this$normalizeCoords4","copy","str","SheetClip","stringify","isEmpty","_coords3","_this$normalizeCoords6","cut","deselectAll","initSizeMatrix","parseInt","temp","_this2","which","keyCode","ctrl","ctrlKey","isMouse","preventDefault","selectAll","paste","parse","_this$normalizeCoords8","_this$obSelector$getR2","getRectangleCoords","_this$normalizeCoords10","select","deselect","destroy","fn","addClass","hasClass","removeClass","classList","add","contains","remove","Buffer","container","initSelectFake","text","_text","fakeElem","setSelectionRange","execCommand","err","isRTL","documentElement","getAttribute","createElement","style","fontSize","border","padding","margin","position","yPosition","pageYOffset","scrollTop","top","concat","appendChild","callback","focus","onInput","target","blur","removeChild","countQuotes","rlen","rows","clen","multiline","last","arr","pop","substring","replace","val","ar","fill","iterateCells","iy","ix","isIgnoredCell","callbackFn","matrix","sizeMatrix","cells","cellVal","countR","countRows","countC","countCols","maxY","maxX","cellFn","y","x","mergeWithCell","_table","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","iterator","next","done","isSelectedCell","deselectCell","return","row","isSelected","loop","_countRows","_iteratorNormalCompletion2","_countCols","_didIteratorError2","_iteratorError2","_step2","_iterator2","rowCrest","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_loop","crestFn","itd","colspan","rowspan","_iterator3","ppn","_this$getRectangleCoo2","result","selectCell","getCell","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","obApp","onMouseOver","onMouseDown","onMouseEnter","onMouseLeave","onMouseUp","onOutTableClick","Error","addEvents","_onMouseOver","_onMouseDown","_onMouseEnter","_onMouseLeave","_onMouseUp","ownerDocument","_onOutTableClick","isRightMB","button","isRightMouseBtn","isMouseDown","_isMouse","removeEvents","g","Function"],"mappings":"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","file":"tcs.bundle.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"../dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","export const getParentTags = function (elem, list) {\r\n    let tagNames = list\r\n        .toLowerCase()\r\n        .split(',')\r\n        .map(function (e) {\r\n            return e.trim();\r\n        });\r\n    if (tagNames.indexOf(elem.tagName.toLowerCase()) > -1) return elem;\r\n    for ( ; elem && elem !== document; elem = elem.parentNode ) {\r\n        if (tagNames.indexOf( elem.tagName.toLowerCase()) > -1) return elem;\r\n    }\r\n    return null;\r\n};\r\n\r\nexport const isElement = function(elem) {\r\n    return elem instanceof Element || elem instanceof HTMLDocument;\r\n};\r\n\r\n/**\r\n * get elements by tag names. Function: getElementsByTagNames(list [,obj])\r\n * @param list of tag names. Example \"td, th\"\r\n * @param obj - parent element\r\n * @returns array elements\r\n */\r\nexport const getElementsByTagNames = function(list, obj) {\r\n    if (!obj) obj = document;\r\n    let tagNames = list.split(',');\r\n    let resultArray = new Array();\r\n    for (let i=0;i<tagNames.length;i++) {\r\n        let tags = obj.getElementsByTagName(tagNames[i].trim());\r\n        for (let j=0;j<tags.length;j++) {\r\n            resultArray.push(tags[j]);\r\n        }\r\n    }\r\n    let testNode = resultArray[0];\r\n    if (!testNode) return [];\r\n    if (testNode.sourceIndex) {\r\n        resultArray.sort(function (a,b) {\r\n            return a.sourceIndex - b.sourceIndex;\r\n        });\r\n    }\r\n    else if (testNode.compareDocumentPosition) {\r\n        resultArray.sort(function (a,b) {\r\n            return 3 - (a.compareDocumentPosition(b) & 6);\r\n        });\r\n    }\r\n    return resultArray;\r\n};\r\n\r\nexport const on = (function() {\r\n    if (document.addEventListener) {\r\n        return function(element, event, handler) {\r\n            if (element && event && handler) {\r\n                element.addEventListener(event, handler, false);\r\n            }\r\n        };\r\n    } else {\r\n        return function(element, event, handler) {\r\n            if (element && event && handler) {\r\n                element.attachEvent('on' + event, handler);\r\n            }\r\n        };\r\n    }\r\n})();\r\n\r\nexport const off = (function() {\r\n    if (document.removeEventListener) {\r\n        return function(element, event, handler) {\r\n            if (element && event) {\r\n                element.removeEventListener(event, handler, false);\r\n            }\r\n        };\r\n    } else {\r\n        return function(element, event, handler) {\r\n            if (element && event) {\r\n                element.detachEvent('on' + event, handler);\r\n            }\r\n        };\r\n    }\r\n})();\r\n\r\n","\"use strict\";\r\n\r\nimport Actions from \"./actions\";\r\nimport _Buffer from \"./buffer\";\r\nimport {isEmpty} from \"./funcs\";\r\nimport Selector from \"./selector\";\r\nimport Table from \"./table\";\r\nimport {off, on} from \"./dom\";\r\nimport {SheetClip} from \"./lib/sheetclip\";\r\n\r\nexport let _gOptions = {\r\n    deselectOutTableClick: true,\r\n    enableChanging: false,\r\n    getCellFn: function (cell, coord) {\r\n        return cell.innerText;\r\n    },\r\n    ignoreClass: 'tcs-ignore',\r\n    ignoreTfoot: false,\r\n    ignoreThead: false,\r\n    initHotkeys: true,\r\n    //TODO: mergePasting: true,\r\n    mergePastingGlue: ' ',\r\n    mouseBlockSelection: true,\r\n    onStartSelect: function (e, cell) { },\r\n    onFinishSelect: function (e) { },\r\n    selectIgnoreClass: true,\r\n    selectClass: 'tcs-select',\r\n    setCellFn: function (cell, data, coord) {\r\n        cell.innerText = data;\r\n    },\r\n    tableClass: 'tcs',// class added to table\r\n    //frozen option:  usingSizeMatrix: true, // !!! for tables with merged cells, enabling is mandatory. Shutdown optimizes performance for simple tables.\r\n};\r\n\r\nexport default class TableCellSelector {\r\n    obActions;\r\n    obBuffer;\r\n    obSelector;\r\n    obTable;\r\n    _onKeyDown = (e) => this.onKeyDown(e);\r\n\r\n    constructor (table, options, buffer) {\r\n        if (typeof options === \"object\") Object.assign(_gOptions, options);\r\n        this.obSelector = new Selector(table);\r\n        this.obTable = new Table(table, this.obSelector, this);\r\n        this.obTable.onStartSelect = _gOptions.onStartSelect;\r\n        this.obTable.onFinishSelect = _gOptions.onFinishSelect;\r\n        this.obActions = new Actions(this.obSelector);\r\n        this.obBuffer = buffer;\r\n        if (_gOptions.initHotkeys) on(document.body, \"keydown\", this._onKeyDown);\r\n    }\r\n\r\n    static get Buffer () {\r\n        return _Buffer;\r\n    }\r\n\r\n    /**\r\n     * clear ([c1 [, c2]])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {boolean}\r\n     */\r\n    clear (c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (coords === false) return false;\r\n            [c1, c2] = coords;\r\n        }\r\n\r\n        if (c2 !== undefined) [c1, c2] = this.normalizeCoords(c1, c2);\r\n        else c2 = c1 = this.normalizeCoords(c1);\r\n\r\n        this.obActions.clear(c1, c2);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * copy ([c1 [, c2]])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {array[][] | false}\r\n     */\r\n    copy (c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (coords === false) return false;\r\n            [c1, c2] = coords;\r\n        }\r\n\r\n        if (c2 !== undefined) [c1, c2] = this.normalizeCoords(c1, c2);\r\n        else c2 = c1 = this.normalizeCoords(c1);\r\n\r\n        const data = this.obActions.copy(c1, c2);\r\n        if (this.obBuffer instanceof _Buffer &&  data !== false) {\r\n            let str = SheetClip.stringify(data);\r\n            this.obBuffer.copy(str);\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * cut ([c1 [, c2]])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {array[][] | false}\r\n     */\r\n    cut (c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (isEmpty(coords)) return false;\r\n            [c1, c2] = coords;\r\n        }\r\n\r\n        if (c2 !== undefined) [c1, c2] = this.normalizeCoords(c1, c2);\r\n        else c2 = c1 = this.normalizeCoords(c1);\r\n\r\n        const data = this.obActions.cut(c1, c2);\r\n        if (this.obBuffer instanceof _Buffer && data !== false) {\r\n            let str = SheetClip.stringify(data);\r\n            this.obBuffer.copy(str);\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {number}\r\n     */\r\n    deselect () {\r\n        return this.obSelector.deselectAll();\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {array[] | false}\r\n     */\r\n    getCoords () {\r\n        return this.obSelector.getSelectedRectangleCoords();\r\n    }\r\n\r\n    /**\r\n     * initialize or re-initialize the size matrix\r\n     */\r\n    initSizeMatrix () {\r\n        this.obSelector.initSizeMatrix();\r\n    }\r\n\r\n\r\n    /**\r\n     * (c1 [, c2])\r\n     * @param c1\r\n     * @param c2\r\n     * @returns {array[][] or array[]}\r\n     */\r\n    normalizeCoords (c1, c2) {\r\n        // normalize\r\n        c1[0] = parseInt(c1[0]) || 0;\r\n        c1[1] = parseInt(c1[1]) || 0;\r\n        if (c2 === undefined) {\r\n            return c1;\r\n        } else {\r\n            c2[0] = parseInt(c2[0]) || 0;\r\n            c2[1] = parseInt(c2[1]) || 0;\r\n            let temp;\r\n            if (c1[0] > c2[0]) {\r\n                temp = c2[0];\r\n                c2[0] = c1[0];\r\n                c1[0] = temp;\r\n            }\r\n            if (c1[1] > c2[1]) {\r\n                temp = c2[1];\r\n                c2[1] = c1[1];\r\n                c1[1] = temp;\r\n            }\r\n            return [c1, c2];\r\n        }\r\n\r\n        // throw new Error(\"Invalid coordinate\");\r\n    }\r\n\r\n    onKeyDown (e) {\r\n        e = e || window.event;\r\n        var key = e.which || e.keyCode; // keyCode detection\r\n        var ctrl = e.ctrlKey ? e.ctrlKey : (key === 17); // ctrl detection\r\n\r\n        if (this.obTable.isMouse && ctrl) {\r\n            switch (key) {\r\n            case 65: // a\r\n                e.preventDefault();\r\n                this.selectAll();\r\n                break;\r\n            case 67: // c\r\n                this.copy();\r\n                break;\r\n            case 86: // v\r\n                if (!_gOptions.enableChanging) break;\r\n                if (this.obBuffer instanceof _Buffer) {\r\n                    this.obBuffer.paste((str) => {\r\n                        this.paste(SheetClip.parse(str));\r\n                    });\r\n                }\r\n                break;\r\n            case 88: // x\r\n                if (!_gOptions.enableChanging) break;\r\n                this.cut();\r\n                break;\r\n            case 46: // delete\r\n            case 8: // backspase\r\n                if (!_gOptions.enableChanging) break;\r\n                this.clear();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    set onStartSelect (fn) {\r\n        this.obTable.onStartSelect = fn;\r\n    }\r\n    set onFinishSelect (fn) {\r\n        this.obTable.onFinishSelect = fn;\r\n    }\r\n\r\n\r\n    /**\r\n     * paste (data [, c1 [, c2]])\r\n     * @param data - array[][]\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     */\r\n    paste (data, c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (coords === false) return false;\r\n            c1 = this.normalizeCoords(coords[0]);\r\n        } else if (c2 !== undefined) {\r\n            [c1, c2] = this.normalizeCoords(c1, c2);\r\n            [c1, c2] = this.obSelector.getRectangleCoords(c1, c2);\r\n        }\r\n        this.obActions.paste(data, c1, c2);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * select (c1 [, c2])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {boolean}\r\n     */\r\n    select (c1, c2) {\r\n        this.obSelector.deselectAll();\r\n        if (c2 !== undefined) {\r\n            [c1, c2] = this.normalizeCoords(c1, c2);\r\n        } else {\r\n            c1 = this.normalizeCoords(c1);\r\n        }\r\n        return this.obSelector.select(c1, c2);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {number}\r\n     */\r\n    selectAll () {\r\n        return this.obSelector.selectAll();\r\n    }\r\n\r\n    destroy () {\r\n        if (_gOptions.initHotkeys) off(document.body, \"keydown\", this._onKeyDown);\r\n        this.deselect();\r\n        this.obTable.destroy();\r\n\r\n        delete\r\n        this.obActions,\r\n        this.obBuffer,\r\n        this.obSelector,\r\n        this.obTable,\r\n        this;\r\n    }\r\n}\r\n\r\nglobal.TableCellSelector = TableCellSelector;\r\n","export const isEmpty = function(value){\r\n    return (value == null || value.length === 0);\r\n};\r\n\r\nexport const addClass = function(elem, name){\r\n    elem.classList.add(name);\r\n};\r\nexport const hasClass = function(elem, name){\r\n    return elem.classList.contains(name);\r\n};\r\nexport const removeClass = function(elem, name){\r\n    elem.classList.remove(name);\r\n};\r\n","import {on, off, isElement} from \"./dom\";\r\n\r\nexport default class Buffer {\r\n    fakeElem;\r\n    _text;\r\n\r\n    constructor (container) {\r\n        this.container = isElement(container) ? container : document.body;\r\n        this.initSelectFake();\r\n    }\r\n\r\n    /**\r\n     * Executes the copy operation based on the current selection.\r\n     */\r\n    copy(text) {\r\n        try {\r\n            this._text = text;\r\n            this.fakeElem.value = text;\r\n            this.fakeElem.select();\r\n            this.fakeElem.setSelectionRange(0, text.length);\r\n            return document.execCommand(\"cut\");\r\n        }\r\n        catch (err) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a fake textarea element, sets its value from `text` property,\r\n     * and makes a selection on it.\r\n     */\r\n    initSelectFake() {\r\n        const isRTL = document.documentElement.getAttribute('dir') == 'rtl';\r\n\r\n        this.fakeElem = document.createElement('textarea');\r\n        // Prevent zooming on iOS\r\n        this.fakeElem.style.fontSize = '12pt';\r\n        // Reset box model\r\n        this.fakeElem.style.border = '0';\r\n        this.fakeElem.style.padding = '0';\r\n        this.fakeElem.style.margin = '0';\r\n        // Move element out of screen horizontally\r\n        this.fakeElem.style.position = 'absolute';\r\n        this.fakeElem.style[ isRTL ? 'right' : 'left' ] = '-9999px';\r\n        // Move element to the same position vertically\r\n        let yPosition = window.pageYOffset || document.documentElement.scrollTop;\r\n        this.fakeElem.style.top = `${yPosition}px`;\r\n\r\n        this.container.appendChild(this.fakeElem);\r\n    }\r\n\r\n    /**\r\n     * Can only be called when the combination is pressed Ctrl + V\r\n     * @returns {string}\r\n     */\r\n    paste (callback) {\r\n        this.fakeElem.value = \"\";\r\n        this.fakeElem.focus();\r\n        let onInput = (e) => {\r\n            this._text = e.target.value;\r\n            this.fakeElem.blur();\r\n            off(this.fakeElem, \"input\", onInput);\r\n            callback(this._text);\r\n        };\r\n        on(this.fakeElem, \"input\", onInput);\r\n    }\r\n\r\n    get text () {\r\n        return this._text;\r\n    }\r\n\r\n    destroy() {\r\n        if (this.fakeElem) {\r\n            this.container.removeChild(this.fakeElem);\r\n            this.fakeElem = null;\r\n        }\r\n    }\r\n}","/**\n * SheetClip - Spreadsheet Clipboard Parser\n * version 0.2\n *\n * This tiny library transforms JavaScript arrays to strings that are pasteable by LibreOffice, OpenOffice,\n * Google Docs and Microsoft Excel.\n *\n * Copyright 2012, Marcin Warpechowski\n * Licensed under the MIT license.\n * http://github.com/warpech/sheetclip/\n */\n/**\n * js-table-cell-selector\n * jslint white: true\n * to ES6 module\n */\n\nfunction countQuotes(str) {\n    return str.split('\"').length - 1;\n}\n\nexport const SheetClip = {\n    parse: function (str) {\n        var r, rlen, rows, arr = [], a = 0, c, clen, multiline, last;\n        rows = str.split('\\n');\n        if (rows.length > 1 && rows[rows.length - 1] === '') {\n            rows.pop();\n        }\n        for (r = 0, rlen = rows.length; r < rlen; r += 1) {\n            rows[r] = rows[r].split('\\t');\n            for (c = 0, clen = rows[r].length; c < clen; c += 1) {\n                if (!arr[a]) {\n                    arr[a] = [];\n                }\n                if (multiline && c === 0) {\n                    last = arr[a].length - 1;\n                    arr[a][last] = arr[a][last] + '\\n' + rows[r][0];\n                    if (multiline && (countQuotes(rows[r][0]) & 1)) { //& 1 is a bitwise way of performing mod 2\n                        multiline = false;\n                        arr[a][last] = arr[a][last].substring(0, arr[a][last].length - 1).replace(/\"\"/g, '\"');\n                    }\n                }\n                else {\n                    if (c === clen - 1 && rows[r][c].indexOf('\"') === 0 && (countQuotes(rows[r][c]) & 1)) {\n                        arr[a].push(rows[r][c].substring(1).replace(/\"\"/g, '\"'));\n                        multiline = true;\n                    }\n                    else {\n                        arr[a].push(rows[r][c].replace(/\"\"/g, '\"'));\n                        multiline = false;\n                    }\n                }\n            }\n            if (!multiline) {\n                a += 1;\n            }\n        }\n        return arr;\n    },\n\n    stringify: function (arr) {\n        var r, rlen, c, clen, str = '', val;\n        for (r = 0, rlen = arr.length; r < rlen; r += 1) {\n            for (c = 0, clen = arr[r].length; c < clen; c += 1) {\n                if (c > 0) {\n                    str += '\\t';\n                }\n                val = arr[r][c];\n                if (typeof val === 'string') {\n                    if (val.indexOf('\\n') > -1) {\n                        str += '\"' + val.replace(/\"/g, '\"\"') + '\"';\n                    }\n                    else {\n                        str += val;\n                    }\n                }\n                else if (val === null || val === void 0) { //void 0 resolves to undefined\n                    str += '';\n                }\n                else {\n                    str += val;\n                }\n            }\n            str += '\\n';\n        }\n        return str;\n    }\n};","import {_gOptions} from \"./app\";\r\nimport {getElementsByTagNames} from \"./dom\";\r\n\r\nexport default class Actions {\r\n    obSelector;\r\n    table;\r\n\r\n    constructor (obSelector) {\r\n        this.obSelector = obSelector;\r\n        this.table = this.obSelector.table;\r\n    }\r\n\r\n    /**\r\n     * Function: copy (c1, c2)\r\n     * @param c1\r\n     * @param c2\r\n     * @returns {array[][]}\r\n     */\r\n    copy (c1, c2) {\r\n        let ar = Array(c2[0] - c1[0] + 1 ).fill().map(\r\n            () => Array(c2[1] - c1[1] + 1 )\r\n        );\r\n\r\n        this.iterateCells(c1, c2, (iy, ix, cell) => {\r\n            ar[iy-c1[0]][ix-c1[1]] = _gOptions.getCellFn(cell, [iy, ix]);\r\n        });\r\n        return ar;\r\n    }\r\n\r\n    /**\r\n     * Function: clear (c1, c2)\r\n     * @param c1\r\n     * @param c2\r\n     */\r\n    clear (c1, c2) {\r\n        this.iterateCells(c1, c2, (iy, ix, cell) => {\r\n            if (!this.obSelector.isIgnoredCell(cell)) {\r\n                _gOptions.setCellFn(cell, \"\", [iy, ix]);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Function: cut (c1, c2)\r\n     * @param c1\r\n     * @param c2\r\n     * @returns {array[][]}\r\n     */\r\n    cut (c1, c2) {\r\n        let ar = Array(c2[0] - c1[0] + 1 ).fill().map(\r\n            () => Array(c2[1] - c1[1] + 1 )\r\n        );\r\n        this.iterateCells(c1, c2, (iy, ix, cell) => {\r\n            ar[iy-c1[0]][ix-c1[1]] = _gOptions.getCellFn(cell, [iy, ix]);\r\n            if (!this.obSelector.isIgnoredCell(cell)) {\r\n                _gOptions.setCellFn(cell, \"\", [iy, ix]);\r\n            }\r\n        });\r\n        return ar;\r\n    }\r\n\r\n    iterateCells (c1, c2, callbackFn) {\r\n        const matrix = this.obSelector.sizeMatrix;\r\n        let rows = this.table.getElementsByTagName(\"tr\");\r\n        for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n            let cells = getElementsByTagNames(\"td,th\", rows[iy]);\r\n            for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                if (!(matrix[iy][ix][0] < 0) && !(matrix[iy][ix][1] < 0)) {\r\n                    callbackFn(iy, ix, cells[matrix[iy][ix][2]]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    mergeWithCell (cell, data, coord) {\r\n        let cellVal = _gOptions.getCellFn(cell, coord).trim();\r\n        if (cellVal === \"\") cellVal = data;\r\n        else if (data !== \"\") cellVal += _gOptions.mergePastingGlue + data;\r\n        _gOptions.setCellFn(cell, cellVal, coord);\r\n    }\r\n\r\n    paste (data, c1, c2) {\r\n        const matrix = this.obSelector.sizeMatrix;\r\n        const rows = this.table.getElementsByTagName(\"tr\");\r\n        const countR = this.obSelector.countRows;\r\n        const countC = this.obSelector.countCols;\r\n\r\n        let maxY = c1[0] + data.length;\r\n        if (maxY > countR) maxY = countR;\r\n        if (c2 !== undefined && maxY > c2[0]) maxY = c2[0]+1;\r\n\r\n        for (let iy = c1[0]; iy < maxY; iy++) {\r\n            let maxX = c1[1] + data[iy-c1[0]].length;\r\n            if (maxX > countC) maxX = countC;\r\n            if (c2 !== undefined && maxX > c2[1]) maxX = c2[1]+1;\r\n\r\n            let cellFn;\r\n            for (let ix = c1[1]; ix < maxX; ix++) {\r\n                let y = iy;\r\n                let x = ix;\r\n                if (matrix[iy][ix][1] < 0 || matrix[iy][ix][0] < 0) {\r\n                    if (matrix[iy][ix][0] < 0) y += matrix[iy][ix][0];\r\n                    if (matrix[iy][ix][1] < 0) x += matrix[iy][ix][1];\r\n                    if (y < c1[0] || x < c1[1]) continue;\r\n                    cellFn = this.mergeWithCell;\r\n                } else {\r\n                    cellFn = _gOptions.setCellFn;\r\n                }\r\n\r\n                let cell = getElementsByTagNames(\"td,th\", rows[y])[matrix[y][x][2]];\r\n                if (!this.obSelector.isIgnoredCell(cell)) {\r\n                    cellFn(cell, data[iy - c1[0]][ix - c1[1]], [y, x]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","import {_gOptions} from \"./app\";\r\nimport {getElementsByTagNames} from \"./dom\";\r\nimport {isEmpty, addClass, hasClass, removeClass} from \"./funcs\";\r\n\r\nexport default class Selector {\r\n    _countCols = 0;\r\n    _countRows = 0;\r\n    _table;\r\n    matrix;\r\n\r\n    constructor (table) {\r\n        this._table = table;\r\n        /*if (_gOptions.usingSizeMatrix) */ this.initSizeMatrix();\r\n    }\r\n\r\n    deselectCell(cell) {\r\n        removeClass(cell, _gOptions.selectClass);\r\n    }\r\n\r\n    deselectAll() {\r\n        let length = 0;\r\n        let list = getElementsByTagNames(\"td,th\", this.table);\r\n\r\n        for (let cell of list) {\r\n            if (this.isSelectedCell(cell)) {\r\n                this.deselectCell(cell);\r\n                length++;\r\n            }\r\n        }\r\n        return length;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param c - coordinate cell. Example [0, 0]\r\n     */\r\n    getCell (c) {\r\n        if (c[0] >= 0 && c[1] >= 0) {\r\n            //if (_gOptions.usingSizeMatrix) {\r\n            if (c[0] < this.countRows && c[1] < this.countCols) {\r\n                if (this.matrix[c[0]][c[1]][0] < 0) c[0] += this.matrix[c[0]][c[1]][0];\r\n                if (this.matrix[c[0]][c[1]][1] < 0) c[1] += this.matrix[c[0]][c[1]][1];\r\n\r\n                let row = this.table.getElementsByTagName(\"tr\")[c[0]];\r\n                return getElementsByTagNames(\"td,th\", row)[this.matrix[c[0]][c[1]][2]];\r\n            }\r\n            /*} else {\r\n                let rows = this.table.getElementsByTagName(\"tr\");\r\n                for (let iy = 0; iy < rows.length; iy++) {\r\n                    if (c[0] != iy) continue;\r\n                    let cols = rows[iy].getElementsByTagName(\"td\");\r\n                    for (let ix = 0; ix < cols.length; ix++) {\r\n                        if (c[1] != ix) continue;\r\n                        return cols[ix];\r\n                    }\r\n                }\r\n            }*/\r\n        }\r\n    }\r\n\r\n    get countCols () {\r\n        return this._countCols;\r\n    }\r\n\r\n    get countRows () {\r\n        return this._countRows;\r\n    }\r\n\r\n    /**\r\n     * get coords of selected cells\r\n     * @returns array [[0, 0], [1, 1]] or false\r\n     */\r\n    getSelectedRectangleCoords () {\r\n        let isSelected = false;\r\n        let c1 = Array(2);\r\n        let c2 = Array(2);\r\n\r\n        //if (_gOptions.usingSizeMatrix) {\r\n        // get extreme points\r\n        let rows = this.table.getElementsByTagName(\"tr\");\r\n        for (let iy = 0; iy < this.countRows; iy++) {\r\n            let cells = getElementsByTagNames(\"td,th\", rows[iy]);\r\n            for (let ix = 0; ix < this.countCols; ix++) {\r\n                if (\r\n                    !(this.matrix[iy][ix][0] < 0)\r\n                    && !(this.matrix[iy][ix][1] < 0)\r\n                    && this.isSelectedCell(cells[this.matrix[iy][ix][2]])\r\n                ) {\r\n                    isSelected = true;\r\n\r\n                    if (c1[0] === undefined || c1[0] > iy) c1[0] = iy;\r\n                    if (c1[1] === undefined || c1[1] > ix) c1[1] = ix;\r\n\r\n                    if (c2[0] === undefined || c2[0] < iy) c2[0] = iy;\r\n                    if (c2[1] === undefined || c2[1] < ix) c2[1] = ix;\r\n                }\r\n            }\r\n        }\r\n        /*} else {\r\n            let rows = this.table.getElementsByTagName(\"tr\");\r\n            for (let iy = 0; iy < rows.length; iy++) {\r\n                let cols = rows[iy].getElementsByTagName(\"td\");\r\n                for (let ix = 0; ix < cols.length; ix++) {\r\n                    if(this.isSelectedCell(cols[ix]))\r\n                    {\r\n                        isSelected = true;\r\n\r\n                        if (c1[0] === undefined || iy < c1[0]) c1[0] = iy;\r\n                        if (c2[0] === undefined || iy > c2[0]) c2[0] = iy;\r\n\r\n                        if (c1[1] === undefined || ix < c1[1]) c1[1] = ix;\r\n                        if (c2[1] === undefined || ix > c2[1]) c2[1] = ix;\r\n                    }\r\n                }\r\n            }\r\n        }*/\r\n        return isSelected ? [c1, c2] : false;\r\n    }\r\n\r\n    get sizeMatrix () {\r\n        return this.matrix;\r\n    }\r\n\r\n    getRectangleCoords (c1, c2) {\r\n        // magic ))\r\n        let loop = true;\r\n        while(loop) {\r\n            loop = false;\r\n\r\n            // min y\r\n            for (let iy = c1[0]; iy <= c1[0]; iy++) {\r\n                for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                    if (this.matrix[iy][ix][0] !== undefined && this.matrix[iy][ix][0] < 0) {\r\n                        c1[0] += this.matrix[iy][ix][0];\r\n                        iy += this.matrix[iy][ix][0] - 1;\r\n                        loop = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // max y\r\n            for (let iy = c2[0]; iy <= c2[0]; iy++) {\r\n                if ((c2[0] + 1) == this.countRows ) continue;\r\n                for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                    if (this.matrix[iy][ix][0] !== undefined && this.matrix[iy + 1][ix][0] < 0) {\r\n                        c2[0]++;\r\n                        loop = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // min x\r\n            for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n                if (this.matrix[iy][c1[1]][1] < 0) {\r\n                    c1[1] += this.matrix[iy][c1[1]][1];\r\n                    iy = c1[0] - 1;\r\n                    loop = true;\r\n                    // break;\r\n                }\r\n            }\r\n\r\n            // max x\r\n            for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n                if ((c2[1] + 1) == this.countCols) continue;\r\n                if (this.matrix[iy][c2[1]+1][1] < 0) {\r\n                    c2[1]++;\r\n                    iy = c1[0] - 1;\r\n                    loop = true;\r\n                    // break;\r\n                }\r\n            }\r\n        }\r\n        return [c1, c2];\r\n    }\r\n\r\n    initSizeMatrix () {\r\n        let rows = this.table.getElementsByTagName(\"tr\");\r\n        this._countRows = rows.length;\r\n        this._countCols = 0;\r\n\r\n        for (let row of rows) {\r\n            let length = getElementsByTagNames(\"td, th\", row).length;\r\n            if (length > this.countCols) {\r\n                this._countCols = length;\r\n            }\r\n        }\r\n\r\n        this.matrix = Array(this.countRows).fill().map(\r\n            () => Array(this.countCols).fill().map(\r\n                () => Array(2)\r\n            )\r\n        );\r\n        let rowCrest = new Array(this.countCols).fill(0);\r\n\r\n        let iy = 0;\r\n        for (let row of rows) {\r\n            let ix = 0;\r\n            let cells = getElementsByTagNames(\"td, th\", row);\r\n            const crestFn = () => {\r\n                while (ix < this.countCols && rowCrest[ix]) {\r\n                    rowCrest[ix]--;\r\n                    this.matrix[iy][ix][0] = this.matrix[iy-1][ix][0] || 0 - 1;\r\n                    this.matrix[iy][ix][1] = this.matrix[iy-1][ix][1];\r\n                    ix++;\r\n                }\r\n            };\r\n\r\n            for (let itd = 0; itd < cells.length; itd++) {\r\n                const cell = cells[itd];\r\n                let colspan = cell.getAttribute(\"colspan\");\r\n                let rowspan = cell.getAttribute(\"rowspan\");\r\n                if (rowspan > 1) this.matrix[iy][ix][0] = 0;\r\n                if (colspan > 1) this.matrix[iy][ix][1] = 0;\r\n\r\n                crestFn();\r\n\r\n                if (colspan > 1) {\r\n                    this.matrix[iy][ix][2] = itd;\r\n                    for (let i = 0; i > -colspan; i--) {\r\n                        this.matrix[iy][ix][1] = i;\r\n                        if (rowspan > 1) rowCrest[ix] = rowspan - 1;\r\n                        ix++;\r\n                    }\r\n                } else {\r\n                    this.matrix[iy][ix][2] = itd;\r\n                    if (rowspan > 1) rowCrest[ix] = rowspan - 1;\r\n                    ix++;\r\n                }\r\n            }\r\n\r\n            crestFn();\r\n            iy++;\r\n        }\r\n    }\r\n\r\n    isIgnoredCell(cell) {\r\n        const ppn = cell.parentNode.parentNode;\r\n        return hasClass(cell, _gOptions.ignoreClass) // td\r\n            || hasClass(cell.parentNode, _gOptions.ignoreClass) // tr\r\n            || (_gOptions.ignoreThead && ppn.tagName === \"THEAD\")\r\n            || (_gOptions.ignoreTfoot && ppn.tagName === \"TFOOT\");\r\n    }\r\n\r\n    isSelectedCell(cell) {\r\n        return hasClass(cell, _gOptions.selectClass);\r\n    }\r\n\r\n    /**\r\n     * select cells. Fn: select (c1 [, c2])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {boolean}\r\n     */\r\n    select (c1, c2)\r\n    {\r\n        if (c2 === undefined || (c1[0] == c2[0] && c1[1] == c2[1])) {\r\n            // normalize\r\n            let cell = this.getCell(c1);\r\n            if (!isEmpty(cell)) {\r\n                return this.selectCell(cell);\r\n            }\r\n        } else {\r\n            let isSelected = false;\r\n\r\n            //if (_gOptions.usingSizeMatrix) {\r\n            if (c1[0] >= this.countRows || c1[1] >= this.countCols || c2[0] < 0 || c2[1] < 0) return false;\r\n            if (c1[0] < 0) c1[0] = 0;\r\n            if (c1[1] < 0) c1[1] = 0;\r\n            if (c2[0] >= this.countRows) c2[0] = this.countRows - 1;\r\n            if (c2[1] >= this.countCols) c2[1] = this.countCols - 1;\r\n\r\n            [c1, c2] = this.getRectangleCoords(c1, c2);\r\n\r\n            let rows = this.table.getElementsByTagName(\"tr\");\r\n            for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n                let cells = getElementsByTagNames(\"td, th\", rows[iy]);\r\n                for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                    if (!(this.matrix[iy][ix][0] < 0) && !(this.matrix[iy][ix][1] < 0)) {\r\n                        let result = this.selectCell(cells[this.matrix[iy][ix][2]]);\r\n                        if (!isSelected) isSelected = result;\r\n                    }\r\n                }\r\n            }\r\n\r\n            /*} else {\r\n\r\n                let rows = this.table.getElementsByTagName(\"tr\");\r\n                for (let iy = 0; iy < rows.length; iy++) {\r\n                    if (iy < c1[0] || iy > c2[0]) continue;\r\n                    let cols = rows[iy].getElementsByTagName(\"td\");\r\n                    for (let ix = 0; ix < cols.length; ix++) {\r\n                        if (ix < c1[1] || ix > c2[1]) continue;\r\n                        let result = this.selectCell(cols[ix]);\r\n                        if (!isSelected) isSelected = result;\r\n                    }\r\n                }\r\n            }*/\r\n            return isSelected;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    selectAll () {\r\n        let length = 0;\r\n        let list = getElementsByTagNames(\"td, th\", this.table);\r\n        for (let cell of list) {\r\n            if (this.selectCell(cell)) {\r\n                length++;\r\n            }\r\n        }\r\n        return length;\r\n    }\r\n\r\n    selectCell(cell) {\r\n        if (_gOptions.selectIgnoreClass || !this.isIgnoredCell(cell)) {\r\n            addClass(cell, _gOptions.selectClass);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    get table () {\r\n        return this._table;\r\n    }\r\n}","import {_gOptions} from \"./app\";\r\nimport {getParentTags, isElement, on, off} from \"./dom\";\r\nimport {addClass, removeClass} from \"./funcs\";\r\n\r\nexport default class Table {\r\n    isMouseDown = false; // whether the left mouse button is pressed\r\n    obApp;\r\n    obSelector;\r\n    onStartSelect;\r\n    onFinishSelect;\r\n    table; // html table\r\n    _isMouse = false;\r\n    _onMouseOver = (e) => this.onMouseOver(e);\r\n    _onMouseDown = (e) => this.onMouseDown(e);\r\n    _onMouseEnter = (e) => this.onMouseEnter(e);\r\n    _onMouseLeave = (e) => this.onMouseLeave(e);\r\n    _onMouseUp = (e) => this.onMouseUp(e);\r\n    _onOutTableClick = (e) => this.onOutTableClick(e);\r\n\r\n    constructor(table, obSelector, obApp) {\r\n        if (isElement(table) && table.tagName === \"TABLE\") {\r\n            this.table = table; // DOM element table\r\n            this.obApp = obApp;\r\n            this.obSelector = obSelector;\r\n            addClass(this.table, _gOptions.tableClass);\r\n            this.addEvents();\r\n        } else {\r\n            throw new Error(\"odule must be initialized to Table\");\r\n        }\r\n    }\r\n\r\n    addEvents() {\r\n        on(this.table, \"mouseover\", this._onMouseOver);\r\n        on(this.table, \"mousedown\", this._onMouseDown);\r\n        on(this.table, \"mouseenter\", this._onMouseEnter);\r\n        on(this.table, \"mouseleave\", this._onMouseLeave);\r\n        on(document.body, \"mouseup\", this._onMouseUp);\r\n        on(this.table.ownerDocument, \"click\", this._onOutTableClick); // click outside the table\r\n    }\r\n\r\n    get isMouse () {\r\n        return this._isMouse;\r\n    }\r\n\r\n    isRightMouseBtn(e) {\r\n        let isRightMB;\r\n        e = e || window.event;\r\n\r\n        if (\"which\" in e)  // Gecko (Firefox), WebKit (Safari/Chrome) & Opera\r\n            isRightMB = e.which == 3;\r\n        else if (\"button\" in e)  // IE, Opera\r\n            isRightMB = e.button == 2;\r\n\r\n        return isRightMB;\r\n    }\r\n\r\n    onMouseDown(e) {\r\n        if (_gOptions.mouseBlockSelection) e.preventDefault();\r\n        if (this.isRightMouseBtn(e)) return true;\r\n\r\n        let cell = getParentTags(e.target, \"td,th\");\r\n        if (cell === null) return; // not for cell\r\n\r\n        this.isMouseDown = true;\r\n\r\n        this.obSelector.deselectAll();\r\n        this.obSelector.selectCell(cell);\r\n        this.onStartSelect(e, cell);\r\n    }\r\n\r\n    onMouseOver(e) {\r\n        if (!this.isMouseDown) return false;\r\n\r\n        let cell = getParentTags(e.target, \"td,th\");\r\n        if (cell === null) return; // not for cell\r\n\r\n        this.obSelector.selectCell(cell);\r\n        //magic selection\r\n        let coords = this.obSelector.getSelectedRectangleCoords();\r\n        if (coords !== false) this.obSelector.select(coords[0], coords[1]);\r\n    }\r\n\r\n    onMouseEnter (e) {\r\n        this._isMouse = true;\r\n    }\r\n\r\n    onMouseLeave (e) {\r\n        this._isMouse = false;\r\n    }\r\n\r\n    onMouseUp(e) {\r\n        if (this.isMouseDown) this.onFinishSelect(e);\r\n        this.isMouseDown = false;\r\n    }\r\n\r\n    onOutTableClick(e) {\r\n        this.isMouseDown = false;\r\n        if (_gOptions.deselectOutTableClick && !this.isMouse) {\r\n            this.obSelector.deselectAll();\r\n        }\r\n    }\r\n\r\n    removeEvents() {\r\n        off(this.table, \"mouseover\", this._onMouseOver);\r\n        off(this.table, \"mousedown\", this._onMouseDown);\r\n        off(this.table, \"mouseenter\", this._onMouseEnter);\r\n        off(this.table, \"mouseleave\", this._onMouseLeave);\r\n        off(document.body, \"mouseup\", this._onMouseUp);\r\n        off(this.table.ownerDocument, \"click\", this._onOutTableClick);\r\n    }\r\n\r\n    destroy() {\r\n        removeClass(this.table, _gOptions.tableClass);\r\n        this.removeEvents();\r\n    }\r\n}","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}