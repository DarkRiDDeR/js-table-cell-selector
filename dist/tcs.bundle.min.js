!function(r){var n={};function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=r,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="../dist/",o(o.s=0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";r.r(t);var n=function(e,t){var r=t.toLowerCase().split(",").map(function(e){return e.trim()});if(-1<r.indexOf(e.tagName.toLowerCase()))return e;for(;e&&e!==document;e=e.parentNode)if(-1<r.indexOf(e.tagName.toLowerCase()))return e;return null},O=function(e,t){t||(t=document);for(var r=e.split(","),n=new Array,o=0;o<r.length;o++)for(var i=t.getElementsByTagName(r[o].trim()),l=0;l<i.length;l++)n.push(i[l]);var a=n[0];return a?(a.sourceIndex?n.sort(function(e,t){return e.sourceIndex-t.sourceIndex}):a.compareDocumentPosition&&n.sort(function(e,t){return 3-(6&e.compareDocumentPosition(t))}),n):[]},i=document.addEventListener?function(e,t,r){e&&t&&r&&e.addEventListener(t,r,!1)}:function(e,t,r){e&&t&&r&&e.attachEvent("on"+t,r)},l=document.removeEventListener?function(e,t,r){e&&t&&e.removeEventListener(t,r,!1)}:function(e,t,r){e&&t&&e.detachEvent("on"+t,r)},h=function(e){return null==e||0===e.length},a=function(e,t){e.classList.add(t)},o=function(e,t){return e.classList.contains(t)},s=function(e,t){e.classList.remove(t)};function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var l,a=e[Symbol.iterator]();!(n=(l=a.next()).done)&&(r.push(l.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var f=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,"countCols",0),c(this,"countRows",0),c(this,"matrix",void 0),c(this,"table",void 0),this.table=e,this.initSizeMatrix()}var e,r,n;return e=t,(r=[{key:"deselectCell",value:function(e){s(e,x.selectClass)}},{key:"deselectAll",value:function(){var e=0,t=O("td,th",this.table),r=!0,n=!1,o=void 0;try{for(var i,l=t[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var a=i.value;this.isSelectedCell(a)&&(this.deselectCell(a),e++)}}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return e}},{key:"destroySizeMatrix",value:function(){this.countCols=void 0,this.countRows=void 0,this.matrix=void 0}},{key:"getCell",value:function(e){if(Array.isArray(e)){if(e[0]=parseInt(e[0])||0,e[1]=parseInt(e[1])||0,0<=e[0]&&0<=e[1]&&e[0]<this.countRows&&e[1]<this.countCols){this.matrix[e[0]][e[1]][0]<0&&(e[0]+=this.matrix[e[0]][e[1]][0]),this.matrix[e[0]][e[1]][1]<0&&(e[1]+=this.matrix[e[0]][e[1]][1]);for(var t=0,r=this.table.getElementsByTagName("tr")[e[0]],n=0;n<this.countCols;n++)if(!(this.matrix[e[0]][n][0]<0||this.matrix[e[0]][n][1]<0)){if(e[1]==n)return O("td,th",r)[t];t++}}return null}throw new Error("Invalid coordinate")}},{key:"getCountCols",value:function(){return this.countCols}},{key:"getCountRows",value:function(){return this.countRows}},{key:"getSelectedRectangleCoords",value:function(){for(var e=!1,t=Array(2),r=Array(2),n=this.table.getElementsByTagName("tr"),o=0;o<this.countRows;o++)for(var i=O("td,th",n[o]),l=0,a=0;a<this.countCols;a++)this.matrix[o][a][0]<0||this.matrix[o][a][1]<0||(this.isSelectedCell(i[l])&&(e=!0,(void 0===t[0]||t[0]>o)&&(t[0]=o),(void 0===t[1]||t[1]>a)&&(t[1]=a),(void 0===r[0]||r[0]<o)&&(r[0]=o),(void 0===r[1]||r[1]<a)&&(r[1]=a)),l++);return!!e&&[t,r]}},{key:"getSizeMatrix",value:function(){return this.matrix}},{key:"getRectangleCoords",value:function(e,t){for(var r=!0;r;){r=!1;for(var n=e[0];n<=e[0];n++)for(var o=e[1];o<=t[1];o++)if(void 0!==this.matrix[n][o][0]&&this.matrix[n][o][0]<0){e[0]+=this.matrix[n][o][0],n+=this.matrix[n][o][0]-1,r=!0;break}for(var i=t[0];i<=t[0];i++)if(t[0]+1!=this.countRows)for(var l=e[1];l<=t[1];l++)if(void 0!==this.matrix[i][l][0]&&this.matrix[i+1][l][0]<0){t[0]++,r=!0;break}for(var a=e[0];a<=t[0];a++)this.matrix[a][e[1]][1]<0&&(e[1]+=this.matrix[a][e[1]][1],a=e[0]-1,r=!0);for(var s=e[0];s<=t[0];s++)t[1]+1!=this.countCols&&this.matrix[s][t[1]+1][1]<0&&(t[1]++,s=e[0]-1,r=!0)}return[e,t]}},{key:"getTable",value:function(){return this.table}},{key:"initSizeMatrix",value:function(){var e=this,t=this.table.getElementsByTagName("tr");this.countRows=t.length;var r=!(this.countCols=0),n=!1,o=void 0;try{for(var i,l=t[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var a=i.value,s=O("td, th",a).length;s>this.countCols&&(this.countCols=s)}}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}this.matrix=Array(this.countRows).fill().map(function(){return Array(e.countCols).fill().map(function(){return Array(2)})});var u=new Array(this.countCols).fill(0),c=0,f=!0,h=!1,v=void 0;try{for(var d,b=t[Symbol.iterator]();!(f=(d=b.next()).done);f=!0){var y=d.value,m=0,g=O("td, th",y),C=!0,p=!1,w=void 0;try{for(var S,k=g[Symbol.iterator]();!(C=(S=k.next()).done);C=!0){var x=S.value,A=x.getAttribute("colspan"),T=x.getAttribute("rowspan");for(1<A&&(this.matrix[c][m][1]=0),1<T&&(this.matrix[c][m][0]=0);m<this.countCols&&u[m];)u[m]--,this.matrix[c][m][0]=this.matrix[c-1][m][0]||-1,this.matrix[c][m][1]=this.matrix[c-1][m][1],m++;if(1<A)for(var M=0;-A<M;M--)this.matrix[c][m][1]=M,1<T&&(u[m]=T-1),m++;else 1<T&&(u[m]=T-1),m++}}catch(e){p=!0,w=e}finally{try{C||null==k.return||k.return()}finally{if(p)throw w}}c++}}catch(e){h=!0,v=e}finally{try{f||null==b.return||b.return()}finally{if(h)throw v}}}},{key:"isIgnoredCell",value:function(e){return o(e,x.ignoreClass)||o(e.parentNode,x.ignoreClass)||o(e.parentNode.parentNode,x.ignoreClass)}},{key:"isSelectedCell",value:function(e){return o(e,x.selectClass)}},{key:"normalizeCoords",value:function(e,t){var r;return e[0]=parseInt(e[0])||0,e[1]=parseInt(e[1])||0,t[0]=parseInt(t[0])||0,t[1]=parseInt(t[1])||0,e[0]>t[0]&&(r=t[0],t[0]=e[0],e[0]=r),e[1]>t[1]&&(r=t[1],t[1]=e[1],e[1]=r),[e,t]}},{key:"select",value:function(e,t){if(!Array.isArray(e)||!Array.isArray(t)&&void 0!==t)throw new Error("Invalid selection positions");if(void 0!==t&&(e[0]!=t[0]||e[1]!=t[1])){var r=!1,n=v(this.normalizeCoords(e,t),2);if(e=n[0],t=n[1],e[0]>=this.countRows||e[1]>=this.countCols||t[0]<0||t[1]<0)return!1;e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),t[0]>=this.countRows&&(t[0]=this.countRows-1),t[1]>=this.countCols&&(t[1]=this.countCols-1);var o=v(this.getRectangleCoords(e,t),2);e=o[0],t=o[1];for(var i=this.table.getElementsByTagName("tr"),l=e[0];l<=t[0];l++)for(var a=O("td, th",i[l]),s=0,u=0;u<this.countCols;u++)if(!(this.matrix[l][u][0]<0||this.matrix[l][u][1]<0)){if(e[1]<=u&&u<=t[1]){var c=this.selectCell(a[s]);r||(r=c)}s++}return r}var f=this.getCell(e);return!h(f)&&this.selectCell(f)}},{key:"selectAll",value:function(){var e=0,t=O("td, th",this.table),r=!0,n=!1,o=void 0;try{for(var i,l=t[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var a=i.value;this.selectCell(a)&&e++}}catch(e){n=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return e}},{key:"selectCell",value:function(e){return!(!x.selectIgnoreClass&&this.isIgnoredCell(e))&&(a(e,x.selectClass),!0)}}])&&u(e.prototype,r),n&&u(e,n),t}();function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=function(){function o(e,t){var r,n=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),b(this,"isMouseDown",!1),b(this,"obSelector",void 0),b(this,"table",void 0),b(this,"_onMouseOver",function(e){return n.onMouseOver(e)}),b(this,"_onMouseDown",function(e){return n.onMouseDown(e)}),b(this,"_onMouseUp",function(e){return n.onMouseUp(e)}),b(this,"_onOutTableClick",function(e){return n.onOutTableClick(e)}),!((r=e)instanceof Element||r instanceof HTMLDocument)||"TABLE"!==e.tagName)throw new Error("Ðœodule must be initialized to Table");this.table=e,this.obSelector=t,a(this.table,x.selectableTableClass),this.addEvents()}var e,t,r;return e=o,(t=[{key:"addEvents",value:function(){i(this.table,"mouseover",this._onMouseOver),i(this.table,"mousedown",this._onMouseDown),i(this.table,"mouseup",this._onMouseUp),i(this.table.ownerDocument,"click",this._onOutTableClick)}},{key:"destroy",value:function(){s(this.table,x.selectableTableClass),this.removeEvents()}},{key:"isRightMouseBtn",value:function(e){var t;return"which"in(e=e||window.event)?t=3==e.which:"button"in e&&(t=2==e.button),t}},{key:"onMouseDown",value:function(e){if(e.preventDefault(),this.isRightMouseBtn(e))return!0;var t=n(e.target,"td,th");null!==t&&(this.isMouseDown=!0,this.obSelector.deselectAll(),this.obSelector.selectCell(t))}},{key:"onMouseOver",value:function(e){if(!this.isMouseDown)return!1;var t=n(e.target,"td,th");if(null!==t){this.obSelector.selectCell(t);var r=this.obSelector.getSelectedRectangleCoords();!1!==r&&this.obSelector.select(r[0],r[1])}}},{key:"onMouseUp",value:function(e){this.isMouseDown=!1}},{key:"onOutTableClick",value:function(e){this.isMouseDown=!1,x.deselectOutTableClick&&!n(e.target,"table")&&this.obSelector.deselectAll()}},{key:"removeEvents",value:function(){l(this.table,"mouseover",this._onMouseOver),l(this.table,"mousedown",this._onMouseDown),l(this.table,"mouseup",this._onMouseUp),l(this.table.ownerDocument,"click",this._onOutTableClick)}}])&&d(e.prototype,t),r&&d(e,r),o}();function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var C=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),g(this,"obSelector",void 0),g(this,"table",void 0),this.obSelector=e,this.table=this.obSelector.getTable()}var e,r,n;return e=t,(r=[{key:"copy",value:function(n,e){void 0===e&&(e=n);var o=Array(e[0]-n[0]+1).fill().map(function(){return Array(e[1]-n[1]+1)});return this.iterateCells(n,e,function(e,t,r){o[e-n[0]][t-n[1]]=x.getCellFn(r,[e,t])}),o}},{key:"clear",value:function(e,t){var n=this;void 0===t&&(t=e),this.iterateCells(e,t,function(e,t,r){n.obSelector.isIgnoredCell(r)||x.setCellFn(r,"",[e,t])})}},{key:"cut",value:function(n,e){var o=this;void 0===e&&(e=n);var i=Array(e[0]-n[0]+1).fill().map(function(){return Array(e[1]-n[1]+1)});return this.iterateCells(n,e,function(e,t,r){i[e-n[0]][t-n[1]]=x.getCellFn(r,[e,t]),o.obSelector.isIgnoredCell(r)||x.setCellFn(r,"",[e,t])}),i}},{key:"getCellData",value:function(e){return e.innerHTML}},{key:"iterateCells",value:function(e,t,r){for(var n=this.obSelector.getSizeMatrix(),o=this.table.getElementsByTagName("tr"),i=e[0];i<=t[0];i++)for(var l=O("td,th",o[i]),a=0,s=0;s<n[i].length;s++)n[i][s][0]<0||n[i][s][1]<0||(e[1]<=s&&s<=t[1]&&r(i,s,l[a]),a++)}},{key:"mergeWithCell",value:function(e,t,r){var n=x.getCellFn(e,r).trim();""===n?n=t:""!==t&&(n+=x.mergePastingGlue+t),x.setCellFn(e,n,r)}},{key:"paste",value:function(e,t,r){var n=this.obSelector.getSizeMatrix(),o=this.table.getElementsByTagName("tr"),i=this.obSelector.getCountRows(),l=this.obSelector.getCountCols(),a=t[0]+e.length;i<a&&(a=i),a>r[0]&&(a=r[0]+1);for(var s=t[0];s<a;s++){var u=O("td,th",o[s]),c=0,f=t[1]+e[s-t[0]].length;l<f&&(f=l),f>r[1]&&(f=r[1]+1);for(var h=0;h<f;h++)if(n[s][h][0]<0)for(var v=s+n[s][h][0],d=0,b=O("td,th",o[v]),y=0;y<f;y++)if(n[v][y][1]<=0){if(!(y!=h||this.obSelector.isIgnoredCell(u[d])||(this.mergeWithCell(b[d],e[s-t[0]][h-t[1]],[v,y+n[v][y][1]]),n[v][y][1]<0)))break}else d++;else if(n[s][h][1]<0){if(!this.obSelector.isIgnoredCell(u[c-1])){var m=[s,h+n[s][h][1]];this.mergeWithCell(u[c-1],e[s-t[0]][h-t[1]],m)}}else t[1]<=h&&!this.obSelector.isIgnoredCell(u[c])&&x.setCellFn(u[c],e[s-t[0]][h-t[1]],[s,h]),c++}}}])&&m(e.prototype,r),n&&m(e,n),t}();function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var l,a=e[Symbol.iterator]();!(n=(l=a.next()).done)&&(r.push(l.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"_gOptions",function(){return x}),r.d(t,"default",function(){return A});var x={deselectOutTableClick:!0,getCellFn:function(e,t){return e.innerText},ignoreClass:"tcs-ignore",mergePastingGlue:" ",selectableTableClass:"tcs",selectIgnoreClass:!0,selectClass:"tcs-select",setCellFn:function(e,t,r){e.innerText=t}},A=function(){function r(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),k(this,"obTable",void 0),k(this,"obSelector",void 0),k(this,"obActions",void 0),"object"===w(t)&&Object.assign(x,t),this.obSelector=new f(e),this.obTable=new y(e,this.obSelector),this.obActions=new C(this.obSelector)}var e,t,n;return e=r,(t=[{key:"clear",value:function(e,t){if(void 0===e){var r=this.obSelector.getSelectedRectangleCoords();if(!1===r)return!1;var n=p(r,2);e=n[0],t=n[1]}return this.obActions.clear(e,t)}},{key:"copy",value:function(e,t){if(void 0===e){var r=this.obSelector.getSelectedRectangleCoords();if(!1===r)return!1;var n=p(r,2);e=n[0],t=n[1]}return this.obActions.copy(e,t)}},{key:"cut",value:function(e,t){if(void 0===e){var r=this.obSelector.getSelectedRectangleCoords();if(h(r))return!1;var n=p(r,2);e=n[0],t=n[1]}return this.obActions.cut(e,t)}},{key:"deselect",value:function(){return this.obSelector.deselectAll()}},{key:"destroy",value:function(){this.deselect(),this.obTable.destroy(),delete this.obTable,delete this.obSelector,delete this.obActions}},{key:"destroySizeMatrix",value:function(){this.obSelector.destroySizeMatrix()}},{key:"getCoords",value:function(){return this.obSelector.getSelectedRectangleCoords()}},{key:"paste",value:function(e,t,r){if(void 0===t){var n=this.obSelector.getSelectedRectangleCoords();if(h(n))return!1;var o=p(n,2);t=o[0],r=o[1]}else if(void 0===r)r=t;else{var i=p(this/this.obSelector.normalizeCoords(t,r),2);t=i[0],r=i[1]}return this.obActions.paste(e,t,r),!0}},{key:"select",value:function(e,t){return this.obSelector.deselectAll(),this.obSelector.select(e,t)}},{key:"selectAll",value:function(){return this.obSelector.selectAll()}}])&&S(e.prototype,t),n&&S(e,n),r}();window&&(window.TableCellSelector=A)}]);