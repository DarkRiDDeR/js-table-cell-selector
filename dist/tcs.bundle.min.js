!function(n){var o={};function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=n,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="../dist/",r(r.s=0)}([function(e,t,n){e.exports=n(2)},function(e,t){!function(e){"use strict";function c(e){return e.split('"').length-1}window.SheetClip={parse:function(e){var t,n,o,r,i,l,s,a=[],u=0;for(1<(o=e.split("\n")).length&&""===o[o.length-1]&&o.pop(),t=0,n=o.length;t<n;t+=1){for(o[t]=o[t].split("\t"),r=0,i=o[t].length;r<i;r+=1)a[u]||(a[u]=[]),l&&0===r?(s=a[u].length-1,a[u][s]=a[u][s]+"\n"+o[t][0],l&&1&c(o[t][0])&&(l=!1,a[u][s]=a[u][s].substring(0,a[u][s].length-1).replace(/""/g,'"'))):l=r===i-1&&0===o[t][r].indexOf('"')&&1&c(o[t][r])?(a[u].push(o[t][r].substring(1).replace(/""/g,'"')),!0):(a[u].push(o[t][r].replace(/""/g,'"')),!1);l||(u+=1)}return a},stringify:function(e){var t,n,o,r,i,l="";for(t=0,n=e.length;t<n;t+=1){for(o=0,r=e[t].length;o<r;o+=1)0<o&&(l+="\t"),"string"==typeof(i=e[t][o])?-1<i.indexOf("\n")?l+='"'+i.replace(/"/g,'""')+'"':l+=i:l+=null==i?"":i;l+="\n"}return l}}}()},function(e,t,n){"use strict";n.r(t);var o=function(e,t){var n=t.toLowerCase().split(",").map(function(e){return e.trim()});if(-1<n.indexOf(e.tagName.toLowerCase()))return e;for(;e&&e!==document;e=e.parentNode)if(-1<n.indexOf(e.tagName.toLowerCase()))return e;return null},i=function(e){return e instanceof Element||e instanceof HTMLDocument},T=function(e,t){t||(t=document);for(var n=e.split(","),o=new Array,r=0;r<n.length;r++)for(var i=t.getElementsByTagName(n[r].trim()),l=0;l<i.length;l++)o.push(i[l]);var s=o[0];return s?(s.sourceIndex?o.sort(function(e,t){return e.sourceIndex-t.sourceIndex}):s.compareDocumentPosition&&o.sort(function(e,t){return 3-(6&e.compareDocumentPosition(t))}),o):[]},l=document.addEventListener?function(e,t,n){e&&t&&n&&e.addEventListener(t,n,!1)}:function(e,t,n){e&&t&&n&&e.attachEvent("on"+t,n)},s=document.removeEventListener?function(e,t,n){e&&t&&e.removeEventListener(t,n,!1)}:function(e,t,n){e&&t&&e.detachEvent("on"+t,n)};function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,"_action",void 0),a(this,"obSelector",void 0),a(this,"table",void 0),this.obSelector=e,this.table=this.obSelector.getTable()}var e,n,o;return e=t,o=[{key:"TYPE_CLEAR",get:function(){return"clear"}},{key:"TYPE_COPY",get:function(){return"copy"}},{key:"TYPE_CUT",get:function(){return"cut"}},{key:"TYPE_PASTE",get:function(){return"paste"}}],(n=[{key:"copy",value:function(o,e){void 0===e&&(e=o);var r=Array(e[0]-o[0]+1).fill().map(function(){return Array(e[1]-o[1]+1)});return this.iterateCells(o,e,function(e,t,n){r[e-o[0]][t-o[1]]=A.getCellFn(n,[e,t])}),this._action=this.TYPE_COPY,r}},{key:"clear",value:function(e,t){var o=this;void 0===t&&(t=e),this.iterateCells(e,t,function(e,t,n){o.obSelector.isIgnoredCell(n)||A.setCellFn(n,"",[e,t])}),this._action=this.TYPE_CLEAR}},{key:"cut",value:function(o,e){var r=this;void 0===e&&(e=o);var i=Array(e[0]-o[0]+1).fill().map(function(){return Array(e[1]-o[1]+1)});return this.iterateCells(o,e,function(e,t,n){i[e-o[0]][t-o[1]]=A.getCellFn(n,[e,t]),r.obSelector.isIgnoredCell(n)||A.setCellFn(n,"",[e,t])}),this._action=this.TYPE_CUT,i}},{key:"getAction",value:function(){return this._action}},{key:"getCellData",value:function(e){return e.innerHTML}},{key:"iterateCells",value:function(e,t,n){for(var o=this.obSelector.getSizeMatrix(),r=this.table.getElementsByTagName("tr"),i=e[0];i<=t[0];i++)for(var l=T("td,th",r[i]),s=0,a=0;a<o[i].length;a++)o[i][a][0]<0||o[i][a][1]<0||(e[1]<=a&&a<=t[1]&&n(i,a,l[s]),s++)}},{key:"mergeWithCell",value:function(e,t,n){var o=A.getCellFn(e,n).trim();""===o?o=t:""!==t&&(o+=A.mergePastingGlue+t),A.setCellFn(e,o,n)}},{key:"paste",value:function(e,t,n){var o=this.obSelector.getSizeMatrix(),r=this.table.getElementsByTagName("tr"),i=this.obSelector.getCountRows(),l=this.obSelector.getCountCols(),s=t[0]+e.length;i<s&&(s=i),s>n[0]&&(s=n[0]+1);for(var a=t[0];a<s;a++){var u=T("td,th",r[a]),c=0,f=t[1]+e[a-t[0]].length;l<f&&(f=l),f>n[1]&&(f=n[1]+1);for(var h=0;h<f;h++)if(o[a][h][0]<0)for(var v=a+o[a][h][0],y=0,d=T("td,th",r[v]),b=0;b<f;b++)if(o[v][b][1]<=0){if(!(b!=h||this.obSelector.isIgnoredCell(u[y])||(this.mergeWithCell(d[y],e[a-t[0]][h-t[1]],[v,b+o[v][b][1]]),o[v][b][1]<0)))break}else y++;else if(o[a][h][1]<0){if(!this.obSelector.isIgnoredCell(u[c-1])){var m=[a,h+o[a][h][1]];this.mergeWithCell(u[c-1],e[a-t[0]][h-t[1]],m)}}else t[1]<=h&&!this.obSelector.isIgnoredCell(u[c])&&A.setCellFn(u[c],e[a-t[0]][h-t[1]],[a,h]),c++}this._action=this.TYPE_PASTE}}])&&r(e.prototype,n),o&&r(e,o),t}();function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(){function n(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),f(this,"fakeElem",void 0),f(this,"isMouse",!1),f(this,"_text",void 0),f(this,"_onInput",function(e){return t.onInput(e)}),f(this,"_onMouseEnter",function(e){return t.onMouseEnter(e)}),f(this,"_onMouseLeave",function(e){return t.onMouseLeave(e)}),f(this,"_onKeyDown",function(e){return t.onKeyDown(e)}),this.container=i(e)?e:document.body,this.initSelectFake(),this.container!==document.body?(l(this.container,"mouseenter",this._onMouseEnter),l(this.container,"mouseleave",this._onMouseLeave)):this.isMouse=!0,l(document.body,"keydown",this._onKeyDown)}var e,t,o;return e=n,(t=[{key:"copy",value:function(e){try{return this._text=e,this.fakeElem.value=e,this.select(this.fakeElem),document.execCommand("cut")}catch(e){return!1}}},{key:"initSelectFake",value:function(){this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",document.body.appendChild(this.fakeElem)}},{key:"onInput",value:function(e){this._text=e.target.value,this.fakeElem.blur(),s(this.fakeElem,"input",this._onInput)}},{key:"onKeyDown",value:function(e){if(this.isMouse){var t=(e=e||window.event).which||e.keyCode;(e.ctrlKey?e.ctrlKey:17===t)&&86==t&&(this.fakeElem.value="",l(this.fakeElem,"input",this._onInput),this.fakeElem.focus())}}},{key:"onMouseEnter",value:function(e){this.isMouse=!0}},{key:"onMouseLeave",value:function(e){this.isMouse=!1}},{key:"paste",value:function(){return this.fakeElem.focus(),this.fakeElem.value="",this.fakeElem.value}},{key:"select",value:function(e){e.select(),e.setSelectionRange(0,e.value.length)}},{key:"destroy",value:function(){this.container!==document.body&&(s(this.container,"mouseenter",this._onMouseEnter),s(this.container,"mouseleave",this._onMouseLeave)),s(document.body,"keydown",this._onKeyDown),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"text",get:function(){return this._text}}])&&c(e.prototype,t),o&&c(e,o),n}(),v=function(e){return null==e||0===e.length},y=function(e,t){e.classList.add(t)},d=function(e,t){return e.classList.contains(t)},b=function(e,t){e.classList.remove(t)};function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var l,s=e[Symbol.iterator]();!(o=(l=s.next()).done)&&(n.push(l.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,"countCols",0),p(this,"countRows",0),p(this,"matrix",void 0),p(this,"table",void 0),this.table=e,this.initSizeMatrix()}var e,n,o;return e=t,(n=[{key:"deselectCell",value:function(e){b(e,A.selectClass)}},{key:"deselectAll",value:function(){var e=0,t=T("td,th",this.table),n=!0,o=!1,r=void 0;try{for(var i,l=t[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var s=i.value;this.isSelectedCell(s)&&(this.deselectCell(s),e++)}}catch(e){o=!0,r=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw r}}return e}},{key:"destroySizeMatrix",value:function(){this.countCols=void 0,this.countRows=void 0,this.matrix=void 0}},{key:"getCell",value:function(e){if(Array.isArray(e)){if(e[0]=parseInt(e[0])||0,e[1]=parseInt(e[1])||0,0<=e[0]&&0<=e[1]&&e[0]<this.countRows&&e[1]<this.countCols){this.matrix[e[0]][e[1]][0]<0&&(e[0]+=this.matrix[e[0]][e[1]][0]),this.matrix[e[0]][e[1]][1]<0&&(e[1]+=this.matrix[e[0]][e[1]][1]);for(var t=0,n=this.table.getElementsByTagName("tr")[e[0]],o=0;o<this.countCols;o++)if(!(this.matrix[e[0]][o][0]<0||this.matrix[e[0]][o][1]<0)){if(e[1]==o)return T("td,th",n)[t];t++}}return null}throw new Error("Invalid coordinate")}},{key:"getCountCols",value:function(){return this.countCols}},{key:"getCountRows",value:function(){return this.countRows}},{key:"getSelectedRectangleCoords",value:function(){for(var e=!1,t=Array(2),n=Array(2),o=this.table.getElementsByTagName("tr"),r=0;r<this.countRows;r++)for(var i=T("td,th",o[r]),l=0,s=0;s<this.countCols;s++)this.matrix[r][s][0]<0||this.matrix[r][s][1]<0||(this.isSelectedCell(i[l])&&(e=!0,(void 0===t[0]||t[0]>r)&&(t[0]=r),(void 0===t[1]||t[1]>s)&&(t[1]=s),(void 0===n[0]||n[0]<r)&&(n[0]=r),(void 0===n[1]||n[1]<s)&&(n[1]=s)),l++);return!!e&&[t,n]}},{key:"getSizeMatrix",value:function(){return this.matrix}},{key:"getRectangleCoords",value:function(e,t){for(var n=!0;n;){n=!1;for(var o=e[0];o<=e[0];o++)for(var r=e[1];r<=t[1];r++)if(void 0!==this.matrix[o][r][0]&&this.matrix[o][r][0]<0){e[0]+=this.matrix[o][r][0],o+=this.matrix[o][r][0]-1,n=!0;break}for(var i=t[0];i<=t[0];i++)if(t[0]+1!=this.countRows)for(var l=e[1];l<=t[1];l++)if(void 0!==this.matrix[i][l][0]&&this.matrix[i+1][l][0]<0){t[0]++,n=!0;break}for(var s=e[0];s<=t[0];s++)this.matrix[s][e[1]][1]<0&&(e[1]+=this.matrix[s][e[1]][1],s=e[0]-1,n=!0);for(var a=e[0];a<=t[0];a++)t[1]+1!=this.countCols&&this.matrix[a][t[1]+1][1]<0&&(t[1]++,a=e[0]-1,n=!0)}return[e,t]}},{key:"getTable",value:function(){return this.table}},{key:"initSizeMatrix",value:function(){var e=this,t=this.table.getElementsByTagName("tr");this.countRows=t.length;var n=!(this.countCols=0),o=!1,r=void 0;try{for(var i,l=t[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var s=i.value,a=T("td, th",s).length;a>this.countCols&&(this.countCols=a)}}catch(e){o=!0,r=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw r}}this.matrix=Array(this.countRows).fill().map(function(){return Array(e.countCols).fill().map(function(){return Array(2)})});var u=new Array(this.countCols).fill(0),c=0,f=!0,h=!1,v=void 0;try{for(var y,d=t[Symbol.iterator]();!(f=(y=d.next()).done);f=!0){var b=y.value,m=0,g=T("td, th",b),p=!0,C=!1,w=void 0;try{for(var k,S=g[Symbol.iterator]();!(p=(k=S.next()).done);p=!0){var x=k.value,E=x.getAttribute("colspan"),M=x.getAttribute("rowspan");for(1<E&&(this.matrix[c][m][1]=0),1<M&&(this.matrix[c][m][0]=0);m<this.countCols&&u[m];)u[m]--,this.matrix[c][m][0]=this.matrix[c-1][m][0]||-1,this.matrix[c][m][1]=this.matrix[c-1][m][1],m++;if(1<E)for(var _=0;-E<_;_--)this.matrix[c][m][1]=_,1<M&&(u[m]=M-1),m++;else 1<M&&(u[m]=M-1),m++}}catch(e){C=!0,w=e}finally{try{p||null==S.return||S.return()}finally{if(C)throw w}}c++}}catch(e){h=!0,v=e}finally{try{f||null==d.return||d.return()}finally{if(h)throw v}}}},{key:"isIgnoredCell",value:function(e){return d(e,A.ignoreClass)||d(e.parentNode,A.ignoreClass)||d(e.parentNode.parentNode,A.ignoreClass)}},{key:"isSelectedCell",value:function(e){return d(e,A.selectClass)}},{key:"normalizeCoords",value:function(e,t){var n;return e[0]=parseInt(e[0])||0,e[1]=parseInt(e[1])||0,t[0]=parseInt(t[0])||0,t[1]=parseInt(t[1])||0,e[0]>t[0]&&(n=t[0],t[0]=e[0],e[0]=n),e[1]>t[1]&&(n=t[1],t[1]=e[1],e[1]=n),[e,t]}},{key:"select",value:function(e,t){if(!Array.isArray(e)||!Array.isArray(t)&&void 0!==t)throw new Error("Invalid selection positions");if(void 0!==t&&(e[0]!=t[0]||e[1]!=t[1])){var n=!1,o=m(this.normalizeCoords(e,t),2);if(e=o[0],t=o[1],e[0]>=this.countRows||e[1]>=this.countCols||t[0]<0||t[1]<0)return!1;e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),t[0]>=this.countRows&&(t[0]=this.countRows-1),t[1]>=this.countCols&&(t[1]=this.countCols-1);var r=m(this.getRectangleCoords(e,t),2);e=r[0],t=r[1];for(var i=this.table.getElementsByTagName("tr"),l=e[0];l<=t[0];l++)for(var s=T("td, th",i[l]),a=0,u=0;u<this.countCols;u++)if(!(this.matrix[l][u][0]<0||this.matrix[l][u][1]<0)){if(e[1]<=u&&u<=t[1]){var c=this.selectCell(s[a]);n||(n=c)}a++}return n}var f=this.getCell(e);return!v(f)&&this.selectCell(f)}},{key:"selectAll",value:function(){var e=0,t=T("td, th",this.table),n=!0,o=!1,r=void 0;try{for(var i,l=t[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var s=i.value;this.selectCell(s)&&e++}}catch(e){o=!0,r=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw r}}return e}},{key:"selectCell",value:function(e){return!(!A.selectIgnoreClass&&this.isIgnoredCell(e))&&(y(e,A.selectClass),!0)}}])&&g(e.prototype,n),o&&g(e,o),t}();function w(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(){function r(e,t,n){var o=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),k(this,"isMouseDown",!1),k(this,"obApp",void 0),k(this,"obSelector",void 0),k(this,"table",void 0),k(this,"_onKeyDown",function(e){return o.onKeyDown(e)}),k(this,"_onMouseOver",function(e){return o.onMouseOver(e)}),k(this,"_onMouseDown",function(e){return o.onMouseDown(e)}),k(this,"_onMouseUp",function(e){return o.onMouseUp(e)}),k(this,"_onOutTableClick",function(e){return o.onOutTableClick(e)}),!i(e)||"TABLE"!==e.tagName)throw new Error("Мodule must be initialized to Table");this.table=e,this.obApp=n,this.obSelector=t,y(this.table,A.selectableTableClass),this.addEvents()}var e,t,n;return e=r,(t=[{key:"addEvents",value:function(){l(document.body,"keydown",this._onKeyDown),l(this.table,"mouseover",this._onMouseOver),l(this.table,"mousedown",this._onMouseDown),l(this.table,"mouseup",this._onMouseUp),l(this.table.ownerDocument,"click",this._onOutTableClick)}},{key:"destroy",value:function(){b(this.table,A.selectableTableClass),this.removeEvents()}},{key:"isRightMouseBtn",value:function(e){var t;return"which"in(e=e||window.event)?t=3==e.which:"button"in e&&(t=2==e.button),t}},{key:"onKeyDown",value:function(e){var t=(e=e||window.event).which||e.keyCode;(e.ctrlKey?e.ctrlKey:17===t)&&(67==t?this.obApp.copy():86==t||(88==t?this.obApp.cut():46!=t&&8!=t||this.obApp.clear()))}},{key:"onMouseDown",value:function(e){if(e.preventDefault(),this.isRightMouseBtn(e))return!0;var t=o(e.target,"td,th");null!==t&&(this.isMouseDown=!0,this.obSelector.deselectAll(),this.obSelector.selectCell(t))}},{key:"onMouseOver",value:function(e){if(!this.isMouseDown)return!1;var t=o(e.target,"td,th");if(null!==t){this.obSelector.selectCell(t);var n=this.obSelector.getSelectedRectangleCoords();!1!==n&&this.obSelector.select(n[0],n[1])}}},{key:"onMouseUp",value:function(e){this.isMouseDown=!1}},{key:"onOutTableClick",value:function(e){this.isMouseDown=!1,A.deselectOutTableClick&&!o(e.target,"table")&&this.obSelector.deselectAll()}},{key:"removeEvents",value:function(){s(document.body,"keydown",this._onKeyDown),s(this.table,"mouseover",this._onMouseOver),s(this.table,"mousedown",this._onMouseDown),s(this.table,"mouseup",this._onMouseUp),s(this.table.ownerDocument,"click",this._onOutTableClick)}}])&&w(e.prototype,t),n&&w(e,n),r}();function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var l,s=e[Symbol.iterator]();!(o=(l=s.next()).done)&&(n.push(l.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"_gOptions",function(){return A}),n.d(t,"default",function(){return O}),n(1);var A={deselectOutTableClick:!0,enablePasting:!0,getCellFn:function(e,t){return e.innerText},ignoreClass:"tcs-ignore",mergePastingGlue:" ",selectableTableClass:"tcs",selectIgnoreClass:!0,selectClass:"tcs-select",setCellFn:function(e,t,n){e.innerText=t}},O=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),_(this,"obTable",void 0),_(this,"obSelector",void 0),_(this,"obActions",void 0),"object"===E(t)&&Object.assign(A,t),this.obSelector=new C(e),this.obTable=new S(e,this.obSelector,this),this.obActions=new u(this.obSelector),this.obBuffer=new h(e)}var e,t,o;return e=n,(t=[{key:"clear",value:function(e,t){if(void 0===e){var n=this.obSelector.getSelectedRectangleCoords();if(!1===n)return!1;var o=x(n,2);e=o[0],t=o[1]}return this.obActions.clear(e,t)}},{key:"copy",value:function(e,t){if(void 0===e){var n=this.obSelector.getSelectedRectangleCoords();if(!1===n)return!1;var o=x(n,2);e=o[0],t=o[1]}var r=this.obActions.copy(e,t);if(!1!==r){var i=window.SheetClip.stringify(r);this.obBuffer.copy(i)}return r}},{key:"cut",value:function(e,t){if(void 0===e){var n=this.obSelector.getSelectedRectangleCoords();if(v(n))return!1;var o=x(n,2);e=o[0],t=o[1]}var r=this.obActions.cut(e,t);if(!1!==r){var i=window.SheetClip.stringify(r);this.obBuffer.copy(i)}return r}},{key:"deselect",value:function(){return this.obSelector.deselectAll()}},{key:"destroy",value:function(){this.deselect(),this.obBuffer.destroy(),this.obTable.destroy(),delete this.obActions,delete this.obBuffer,delete this.obSelector,delete this.obTable}},{key:"destroySizeMatrix",value:function(){this.obSelector.destroySizeMatrix()}},{key:"initSizeMatrix",value:function(){this.obSelector.initSizeMatrix()}},{key:"getCoords",value:function(){return this.obSelector.getSelectedRectangleCoords()}},{key:"paste",value:function(e,t,n){if(void 0===t){var o=this.obSelector.getSelectedRectangleCoords();if(v(o))return!1;var r=x(o,2);t=r[0],n=r[1]}else if(void 0===n)n=t;else{var i=x(this/this.obSelector.normalizeCoords(t,n),2);t=i[0],n=i[1]}return this.obActions.paste(e,t,n),console.log(this.obBuffer.paste()),!0}},{key:"select",value:function(e,t){return this.obSelector.deselectAll(),this.obSelector.select(e,t)}},{key:"selectAll",value:function(){return this.obSelector.selectAll()}}])&&M(e.prototype,t),o&&M(e,o),n}();window&&(window.TableCellSelector=O)}]);