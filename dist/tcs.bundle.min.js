!function(i){var n={};function o(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=i,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/",o(o.s=0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){"use strict";i.r(e);var m=function(t){return null==t||0===t.length},s=function(t,e){t.classList.add(e)},o=function(t,e){return t.classList.contains(e)},l=function(t,e){t.classList.remove(e)};function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],n=!0,o=!1,r=void 0;try{for(var s,l=t[Symbol.iterator]();!(n=(s=l.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{n||null==l.return||l.return()}finally{if(o)throw r}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var u=function(){function i(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),a(this,"countCols",0),a(this,"countRows",0),a(this,"matrix",void 0),a(this,"options",void 0),a(this,"table",void 0),this.table=t,this.options=e,this.options.usingSizeMatrix&&this.initSizeMatrix()}var t,e,n;return t=i,(e=[{key:"deselectCell",value:function(t){l(t,this.options.selectClass)}},{key:"deselectAll",value:function(){var t=0,e=this.table.getElementsByTagName("td"),i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;this.isSelectedCell(l)&&(this.deselectCell(l),t++)}}catch(t){n=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return t}},{key:"destroySizeMatrix",value:function(){this.countCols=void 0,this.countRows=void 0,this.matrix=void 0}},{key:"getCell",value:function(t){if(Array.isArray(t)){if(t[0]=parseInt(t[0])||0,t[1]=parseInt(t[1])||0,0<=t[0]&&0<=t[1])if(this.options.usingSizeMatrix){if(m(this.matrix)&&this.initSizeMatrix(),t[0]<this.countRows&&t[1]<this.countCols){this.matrix[t[0]][t[1]][0]<0&&(t[0]+=this.matrix[t[0]][t[1]][0]),this.matrix[t[0]][t[1]][1]<0&&(t[1]+=this.matrix[t[0]][t[1]][1]);for(var e=0,i=this.table.getElementsByTagName("tr")[t[0]],n=0;n<this.countCols;n++)if(!(this.matrix[t[0]][n][0]<0||this.matrix[t[0]][n][1]<0)){if(t[1]==n)return i.getElementsByTagName("td")[e];e++}}}else for(var o=this.table.getElementsByTagName("tr"),r=0;r<o.length;r++)if(t[0]==r)for(var s=o[r].getElementsByTagName("td"),l=0;l<s.length;l++)if(t[1]==l)return s[l];return null}throw new Error("Invalid coordinate")}},{key:"getRectangleCoords",value:function(t,e){for(var i=!0;i;){i=!1;for(var n=t[0];n<=t[0];n++)for(var o=t[1];o<=e[1];o++)if(void 0!==this.matrix[n][o][0]&&this.matrix[n][o][0]<0){t[0]+=this.matrix[n][o][0],n+=this.matrix[n][o][0]-1,i=!0;break}for(var r=e[0];r<=e[0];r++)if(e[0]+1!=this.countRows)for(var s=t[1];s<=e[1];s++)if(void 0!==this.matrix[r][s][0]&&this.matrix[r+1][s][0]<0){e[0]++,i=!0;break}for(var l=t[0];l<=e[0];l++)this.matrix[l][t[1]][1]<0&&(t[1]+=this.matrix[l][t[1]][1],l=t[0]-1,i=!0);for(var a=t[0];a<=e[0];a++)e[1]+1!=this.countCols&&this.matrix[a][e[1]+1][1]<0&&(e[1]++,a=t[0]-1,i=!0)}return[t,e]}},{key:"initSizeMatrix",value:function(){var t=this,e=this.table.getElementsByTagName("tr");this.countRows=e.length;var i=!(this.countCols=0),n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value.getElementsByTagName("td").length;l>this.countCols&&(this.countCols=l)}}catch(t){n=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}this.matrix=Array(this.countRows).fill().map(function(){return Array(t.countCols).fill().map(function(){return Array(2)})});var a=new Array(this.countCols).fill(0),u=0,c=!0,h=!1,f=void 0;try{for(var v,y=e[Symbol.iterator]();!(c=(v=y.next()).done);c=!0){var d=v.value,b=0,m=d.getElementsByTagName("td"),g=!0,p=!1,w=void 0;try{for(var x,C=m[Symbol.iterator]();!(g=(x=C.next()).done);g=!0){var S=x.value,T=S.getAttribute("colspan"),k=S.getAttribute("rowspan");for(1<T&&(this.matrix[u][b][1]=0),1<k&&(this.matrix[u][b][0]=0);b<this.countCols&&a[b];)a[b]--,this.matrix[u][b][0]=this.matrix[u-1][b][0]||-1,this.matrix[u][b][1]=this.matrix[u-1][b][1],b++;if(1<T)for(var M=0;-T<M;M--)this.matrix[u][b][1]=M,1<k&&(a[b]=k-1),b++;else 1<k&&(a[b]=k-1),b++}}catch(t){p=!0,w=t}finally{try{g||null==C.return||C.return()}finally{if(p)throw w}}u++}}catch(t){h=!0,f=t}finally{try{c||null==y.return||y.return()}finally{if(h)throw f}}}},{key:"isSelectedCell",value:function(t){return o(t,this.options.selectClass)}},{key:"normalizeCoords",value:function(t,e){var i;return t[0]=parseInt(t[0])||0,t[1]=parseInt(t[1])||0,e[0]=parseInt(e[0])||0,e[1]=parseInt(e[1])||0,t[0]>e[0]&&(i=e[0],e[0]=t[0],t[0]=i),t[1]>e[1]&&(i=e[1],e[1]=t[1],t[1]=i),[t,e]}},{key:"select",value:function(t,e){if(!Array.isArray(t)||!Array.isArray(e)&&void 0!==e)throw new Error("Invalid selection positions");if(void 0!==e&&(t[0]!=e[0]||t[1]!=e[1])){var i=!1,n=g(this.normalizeCoords(t,e),2);if(t=n[0],e=n[1],this.options.usingSizeMatrix){if(m(this.matrix)&&this.initSizeMatrix(),t[0]>=this.countRows||t[1]>=this.countCols||e[0]<0||e[1]<0)return!1;t[0]<0&&(t[0]=0),t[1]<0&&(t[1]=0),e[0]>=this.countRows&&(e[0]=this.countRows-1),e[1]>=this.countCols&&(e[1]=this.countCols-1);var o=g(this.getRectangleCoords(t,e),2);t=o[0],e=o[1];for(var r=this.table.getElementsByTagName("tr"),s=t[0];s<=e[0];s++)for(var l=r[s].getElementsByTagName("td"),a=0,u=0;u<this.countCols;u++)if(!(this.matrix[s][u][0]<0||this.matrix[s][u][1]<0)){if(t[1]<=u&&u<=e[1]){var c=this.selectCell(l[a]);i||(i=c)}a++}}else for(var h=this.table.getElementsByTagName("tr"),f=0;f<h.length;f++)if(!(f<t[0]||f>e[0]))for(var v=h[f].getElementsByTagName("td"),y=0;y<v.length;y++)if(!(y<t[1]||y>e[1])){var d=this.selectCell(v[y]);i||(i=d)}return i}var b=this.getCell(t);return!m(b)&&this.selectCell(b)}},{key:"selectAll",value:function(){var t=0,e=this.table.getElementsByTagName("td"),i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;this.selectCell(l)&&t++}}catch(t){n=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return t}},{key:"selectCell",value:function(t){var e=this.options.ignoreClass;return!(!this.options.selectIgnoreClass&&(o(t,e)||o(t.parentNode,e)||o(t.parentNode.parentNode,e)))&&(s(t,this.options.selectClass),!0)}},{key:"toSelectedRectangle",value:function(){var t=!1,e=Array(2),i=Array(2);if(this.options.usingSizeMatrix)for(var n=this.table.getElementsByTagName("tr"),o=0;o<this.countRows;o++)for(var r=n[o].getElementsByTagName("td"),s=0,l=0;l<this.countCols;l++)this.matrix[o][l][0]<0||this.matrix[o][l][1]<0||(this.isSelectedCell(r[s])&&(t=!0,(void 0===e[0]||e[0]>o)&&(e[0]=o),(void 0===e[1]||e[1]>l)&&(e[1]=l),(void 0===i[0]||i[0]<o)&&(i[0]=o),(void 0===i[1]||i[1]<l)&&(i[1]=l)),s++);else for(var a=this.table.getElementsByTagName("tr"),u=0;u<a.length;u++)for(var c=a[u].getElementsByTagName("td"),h=0;h<c.length;h++)this.isSelectedCell(c[h])&&(t=!0,(void 0===e[0]||u<e[0])&&(e[0]=u),(void 0===i[0]||u>i[0])&&(i[0]=u),(void 0===e[1]||h<e[1])&&(e[1]=h),(void 0===i[1]||h>i[1])&&(i[1]=h));t&&this.select(e,i)}}])&&r(t.prototype,e),n&&r(t,n),i}(),n=function(t,e){if(e=e.toLowerCase(),t.tagName.toLowerCase()===e)return t;for(;t&&t!==document;t=t.parentNode)if(t.tagName.toLowerCase()===e)return t;return null},c=document.addEventListener?function(t,e,i){t&&e&&i&&t.addEventListener(e,i,!1)}:function(t,e,i){t&&e&&i&&t.attachEvent("on"+e,i)},h=document.removeEventListener?function(t,e,i){t&&e&&t.removeEventListener(e,i,!1)}:function(t,e,i){t&&e&&t.detachEvent("on"+e,i)};function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var y=function(){function r(t,e,i){var n,o=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),v(this,"isMouseDown",!1),v(this,"obSelector",void 0),v(this,"options",void 0),v(this,"positions",void 0),v(this,"table",void 0),v(this,"_onMouseOver",function(t){return o.onMouseOver(t)}),v(this,"_onMouseDown",function(t){return o.onMouseDown(t)}),v(this,"_onMouseUp",function(t){return o.onMouseUp(t)}),v(this,"_onOutTableClick",function(t){return o.onOutTableClick(t)}),!((n=t)instanceof Element||n instanceof HTMLDocument)||"TABLE"!==t.tagName)throw new Error("Ðœodule must be initialized to Table");this.table=t,this.obSelector=e,this.options=i,s(this.table,this.options.selectableTableClass),this.addEvents()}var t,e,i;return t=r,(e=[{key:"addEvents",value:function(){c(this.table,"mouseover",this._onMouseOver),c(this.table,"mousedown",this._onMouseDown),c(this.table,"mouseup",this._onMouseUp),c(this.table.ownerDocument,"click",this._onOutTableClick)}},{key:"destroy",value:function(){l(this.table,this.options.selectableTableClass),this.removeEvents()}},{key:"getPositions",value:function(){return this.positions}},{key:"isRightMouseBtn",value:function(t){var e;return"which"in(t=t||window.event)?e=3==t.which:"button"in t&&(e=2==t.button),e}},{key:"onMouseDown",value:function(t){if(t.preventDefault(),!this.matrix&&this.options.usingSizeMatrix&&this.obSelector.initSizeMatrix(),this.isRightMouseBtn(t))return!0;var e=n(t.target,"td");null!==e&&(this.isMouseDown=!0,this.obSelector.deselectAll(),this.obSelector.selectCell(e))}},{key:"onMouseOver",value:function(t){if(!this.isMouseDown)return!1;var e=n(t.target,"td");null!==e&&(this.obSelector.selectCell(e),this.obSelector.toSelectedRectangle())}},{key:"onMouseUp",value:function(t){this.isMouseDown=!1}},{key:"onOutTableClick",value:function(t){this.isMouseDown=!1,this.options.deselectOutTableClick&&!n(t.target,"table")&&this.obSelector.deselectAll(),this.options.destroySizeMatrix&&this.obSelector.destroySizeMatrix()}},{key:"removeEvents",value:function(){h(this.table,"mouseover",this._onMouseOver),h(this.table,"mousedown",this._onMouseDown),h(this.table,"mouseup",this._onMouseUp),h(this.table.ownerDocument,"click",this._onOutTableClick)}}])&&f(t.prototype,e),i&&f(t,i),r}();function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,"default",function(){return w});var w=function(){function i(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),p(this,"options",{deselectOutTableClick:!0,destroySizeMatrix:!1,ignoreClass:"tcs-ignore",mergePastingGlue:" ",selectableTableClass:"tcs",selectIgnoreClass:!0,selectClass:"tcs-select",usingSizeMatrix:!0}),p(this,"obTable",void 0),p(this,"obSelector",void 0),"object"===d(e)&&Object.assign(this.options,e),this.obSelector=new u(t,this.options),this.obTable=new y(t,this.obSelector,this.options)}var t,e,n;return t=i,n=[{key:"GET_DATA_TEXT",get:function(){return"text"}},{key:"GET_DATA_HTML",get:function(){return"html"}},{key:"GET_DATA_JSON",get:function(){return"json"}}],(e=[{key:"deselect",value:function(){return this.obSelector.deselectAll()}},{key:"destroy",value:function(){this.deselect(),this.obTable.destroy()}},{key:"destroySizeMatrix",value:function(){this.obSelector.destroySizeMatrix()}},{key:"getArray",value:function(t){}},{key:"getPositions",value:function(){return this.obTable.getPositions()}},{key:"getJson",value:function(t){}},{key:"paste",value:function(t,e){}},{key:"select",value:function(t,e){return this.obSelector.deselectAll(),this.obSelector.select(t,e)}},{key:"selectAll",value:function(){return this.obSelector.selectAll()}}])&&b(t.prototype,e),n&&b(t,n),i}();window&&(window.TableCellSelector=w)}]);