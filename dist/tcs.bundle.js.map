{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/dom.js","webpack:///./src/app.js","webpack:///./src/funcs.js","webpack:///./src/buffer.js","webpack:///./src/lib/sheetclip.js","webpack:///./src/actions.js","webpack:///./src/selector.js","webpack:///./src/table.js","webpack:///(webpack)/buildin/global.js"],"names":["getParentTags","elem","list","tagNames","toLowerCase","split","map","e","trim","indexOf","tagName","document","parentNode","isElement","Element","HTMLDocument","getElementsByTagNames","obj","resultArray","Array","i","length","tags","getElementsByTagName","j","push","testNode","sourceIndex","sort","a","b","compareDocumentPosition","on","addEventListener","element","event","handler","attachEvent","off","removeEventListener","detachEvent","_gOptions","changeTracking","deselectOutTableClick","enableChanging","getCellFn","cell","coord","innerText","ignoreClass","mergePastingGlue","selectableTableClass","selectIgnoreClass","selectClass","setCellFn","data","TableCellSelector","table","options","buffer","onKeyDown","obSelector","Selector","obTable","Table","obActions","Actions","obBuffer","body","_onKeyDown","c1","c2","undefined","coords","getSelectedRectangleCoords","clear","copy","_Buffer","str","SheetClip","stringify","isEmpty","cut","deselectAll","initSizeMatrix","window","key","which","keyCode","ctrl","ctrlKey","isMouse","preventDefault","selectAll","paste","parse","normalizeCoords","getRectangleCoords","select","deselect","destroy","global","value","addClass","name","classList","add","hasClass","contains","removeClass","remove","Buffer","container","initSelectFake","text","_text","fakeElem","setSelectionRange","execCommand","err","isRTL","documentElement","getAttribute","createElement","style","fontSize","border","padding","margin","position","yPosition","pageYOffset","scrollTop","top","appendChild","callback","focus","onInput","target","blur","removeChild","countQuotes","r","rlen","rows","arr","c","clen","multiline","last","pop","substring","replace","val","getTable","ar","fill","iterateCells","iy","ix","isIgnoredCell","callbackFn","matrix","sizeMatrix","cells","cellVal","countR","countRows","countC","countCols","maxY","maxX","cellFn","y","x","mergeWithCell","isSelectedCell","deselectCell","isArray","parseInt","row","Error","isSelected","loop","_countRows","_countCols","rowCrest","crestFn","itd","colspan","rowspan","temp","getCell","selectCell","result","obApp","onMouseOver","onMouseDown","onMouseEnter","onMouseLeave","onMouseUp","onOutTableClick","addEvents","initObserver","_onMouseOver","_onMouseDown","_onMouseEnter","_onMouseLeave","_onMouseUp","ownerDocument","_onOutTableClick","_Observer","MutationObserver","WebKitMutationObserver","observer","mutations","forEach","observe","childList","subtree","isRightMB","button","isRightMouseBtn","isMouseDown","_isMouse","disconnect","removeEvents"],"mappings":"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","file":"tcs.bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"../dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","export const getParentTags = function (elem, list) {\r\n    let tagNames = list\r\n        .toLowerCase()\r\n        .split(',')\r\n        .map(function (e) {\r\n            return e.trim();\r\n        });\r\n    if (tagNames.indexOf(elem.tagName.toLowerCase()) > -1) return elem;\r\n    for ( ; elem && elem !== document; elem = elem.parentNode ) {\r\n        if (tagNames.indexOf( elem.tagName.toLowerCase()) > -1) return elem;\r\n    }\r\n    return null;\r\n};\r\n\r\nexport const isElement = function(elem) {\r\n    return elem instanceof Element || elem instanceof HTMLDocument;\r\n};\r\n\r\n/**\r\n * get elements by tag names. Function: getElementsByTagNames(list [,obj])\r\n * @param list of tag names. Example \"td, th\"\r\n * @param obj - parent element\r\n * @returns array elements\r\n */\r\nexport const getElementsByTagNames = function(list, obj) {\r\n    if (!obj) obj = document;\r\n    let tagNames = list.split(',');\r\n    let resultArray = new Array();\r\n    for (let i=0;i<tagNames.length;i++) {\r\n        let tags = obj.getElementsByTagName(tagNames[i].trim());\r\n        for (let j=0;j<tags.length;j++) {\r\n            resultArray.push(tags[j]);\r\n        }\r\n    }\r\n    let testNode = resultArray[0];\r\n    if (!testNode) return [];\r\n    if (testNode.sourceIndex) {\r\n        resultArray.sort(function (a,b) {\r\n            return a.sourceIndex - b.sourceIndex;\r\n        });\r\n    }\r\n    else if (testNode.compareDocumentPosition) {\r\n        resultArray.sort(function (a,b) {\r\n            return 3 - (a.compareDocumentPosition(b) & 6);\r\n        });\r\n    }\r\n    return resultArray;\r\n};\r\n\r\nexport const on = (function() {\r\n    if (document.addEventListener) {\r\n        return function(element, event, handler) {\r\n            if (element && event && handler) {\r\n                element.addEventListener(event, handler, false);\r\n            }\r\n        };\r\n    } else {\r\n        return function(element, event, handler) {\r\n            if (element && event && handler) {\r\n                element.attachEvent('on' + event, handler);\r\n            }\r\n        };\r\n    }\r\n})();\r\n\r\nexport const off = (function() {\r\n    if (document.removeEventListener) {\r\n        return function(element, event, handler) {\r\n            if (element && event) {\r\n                element.removeEventListener(event, handler, false);\r\n            }\r\n        };\r\n    } else {\r\n        return function(element, event, handler) {\r\n            if (element && event) {\r\n                element.detachEvent('on' + event, handler);\r\n            }\r\n        };\r\n    }\r\n})();\r\n\r\n","\"use strict\";\r\n\r\nimport Actions from \"./actions\";\r\nimport _Buffer from \"./buffer\";\r\nimport {isEmpty} from \"./funcs\";\r\nimport Selector from \"./selector\";\r\nimport Table from \"./table\";\r\nimport {off, on} from \"./dom\";\r\nimport {SheetClip} from \"./lib/sheetclip\";\r\n\r\nexport let _gOptions = {\r\n    changeTracking: false,\r\n    deselectOutTableClick: true,\r\n    enableChanging: false,\r\n    getCellFn: function (cell, coord) {\r\n        return cell.innerText;\r\n    },\r\n    ignoreClass: 'tcs-ignore',\r\n    //TODO: mergePasting: true,\r\n    mergePastingGlue: ' ',\r\n    selectableTableClass : 'tcs',// class added to table\r\n    selectIgnoreClass: true,\r\n    selectClass: 'tcs-select',\r\n    setCellFn: function (cell, data, coord) {\r\n        cell.innerText = data;\r\n    }\r\n    //frozen option:  usingSizeMatrix: true, // !!! for tables with merged cells, enabling is mandatory. Shutdown optimizes performance for simple tables.\r\n};\r\n\r\nexport default class TableCellSelector {\r\n    obActions;\r\n    obBuffer;\r\n    obSelector;\r\n    obTable;\r\n    _onKeyDown = (e) => this.onKeyDown(e);\r\n\r\n    constructor (table, options, buffer) {\r\n        if (typeof options === \"object\") Object.assign(_gOptions, options);\r\n        this.obSelector = new Selector(table);\r\n        this.obTable = new Table(table, this.obSelector, this);\r\n        this.obActions = new Actions(this.obSelector);\r\n        this.obBuffer = buffer;\r\n        on(document.body, \"keydown\", this._onKeyDown);\r\n    }\r\n\r\n    static get Buffer () {\r\n        return _Buffer;\r\n    }\r\n\r\n    /**\r\n     * clear ([c1 [, c2]])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {boolean}\r\n     */\r\n    clear (c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (coords === false) return false;\r\n            [c1, c2] = coords;\r\n        }\r\n        this.obActions.clear(c1, c2);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * copy ([c1 [, c2]])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {array[][] | false}\r\n     */\r\n    copy (c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (coords === false) return false;\r\n            [c1, c2] = coords;\r\n        }\r\n        const data = this.obActions.copy(c1, c2);\r\n        if (this.obBuffer instanceof _Buffer &&  data !== false) {\r\n            let str = SheetClip.stringify(data);\r\n            this.obBuffer.copy(str);\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * cut ([c1 [, c2]])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {array[][] | false}\r\n     */\r\n    cut (c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (isEmpty(coords)) return false;\r\n            [c1, c2] = coords;\r\n        }\r\n        const data = this.obActions.cut(c1, c2);\r\n        if (this.obBuffer instanceof _Buffer && data !== false) {\r\n            let str = SheetClip.stringify(data);\r\n            this.obBuffer.copy(str);\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {number}\r\n     */\r\n    deselect () {\r\n        return this.obSelector.deselectAll();\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {array[] | false}\r\n     */\r\n    getCoords () {\r\n        return this.obSelector.getSelectedRectangleCoords();\r\n    }\r\n\r\n    /**\r\n     * initialize or re-initialize the size matrix\r\n     */\r\n    initSizeMatrix () {\r\n        this.obSelector.initSizeMatrix();\r\n    }\r\n\r\n    onKeyDown (e) {\r\n        e = e || window.event;\r\n        var key = e.which || e.keyCode; // keyCode detection\r\n        var ctrl = e.ctrlKey ? e.ctrlKey : (key === 17); // ctrl detection\r\n\r\n        if (this.obTable.isMouse && ctrl) {\r\n            switch (key) {\r\n            case 65: // a\r\n                e.preventDefault();\r\n                this.selectAll();\r\n                break;\r\n            case 67: // c\r\n                this.copy();\r\n                break;\r\n            case 86: // v\r\n                if (!_gOptions.enableChanging) break;\r\n                if (this.obBuffer instanceof _Buffer) {\r\n                    this.obBuffer.paste((str) => {\r\n                        this.paste(SheetClip.parse(str));\r\n                    });\r\n                }\r\n                break;\r\n            case 88: // x\r\n                if (!_gOptions.enableChanging) break;\r\n                this.cut();\r\n                break;\r\n            case 46: // delete\r\n            case 8: // backspase\r\n                if (!_gOptions.enableChanging) break;\r\n                this.clear();\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * paste (data [, c1 [, c2]])\r\n     * @param data - array[][]\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     */\r\n    paste (data, c1, c2) {\r\n        if (c1 === undefined) {\r\n            let coords = this.obSelector.getSelectedRectangleCoords();\r\n            if (isEmpty(coords)) return false;\r\n            [c1, c2] = coords;\r\n        } else if (c2 === undefined) {\r\n            c2 = c1;\r\n        } else {\r\n            [c1, c2] = this.obSelector.normalizeCoords(c1, c2);\r\n        }\r\n        [c1, c2] = this.obSelector.getRectangleCoords(c1, c2);\r\n        this.obActions.paste(data, c1, c2);\r\n    }\r\n\r\n    /**\r\n     * select (c1 [, c2])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {boolean}\r\n     */\r\n    select (c1, c2) {\r\n        this.obSelector.deselectAll();\r\n        return this.obSelector.select(c1, c2);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {number}\r\n     */\r\n    selectAll () {\r\n        return this.obSelector.selectAll();\r\n    }\r\n\r\n    destroy () {\r\n        off(document.body, \"keydown\", this._onKeyDown);\r\n        this.deselect();\r\n        this.obBuffer.destroy();\r\n        this.obTable.destroy();\r\n\r\n        delete\r\n        this.obActions,\r\n        this.obBuffer,\r\n        this.obSelector,\r\n        this.obTable,\r\n        this;\r\n    }\r\n}\r\n\r\nglobal.TableCellSelector = TableCellSelector;\r\n","export const isEmpty = function(value){\r\n    return (value == null || value.length === 0);\r\n};\r\n\r\nexport const addClass = function(elem, name){\r\n    elem.classList.add(name);\r\n};\r\nexport const hasClass = function(elem, name){\r\n    return elem.classList.contains(name);\r\n};\r\nexport const removeClass = function(elem, name){\r\n    elem.classList.remove(name);\r\n};\r\n","import {on, off, isElement} from \"./dom\";\r\n\r\nexport default class Buffer {\r\n    fakeElem;\r\n    _text;\r\n\r\n    constructor (container) {\r\n        this.container = isElement(container) ? container : document.body;\r\n        this.initSelectFake();\r\n    }\r\n\r\n    /**\r\n     * Executes the copy operation based on the current selection.\r\n     */\r\n    copy(text) {\r\n        try {\r\n            this._text = text;\r\n            this.fakeElem.value = text;\r\n            this.fakeElem.select();\r\n            this.fakeElem.setSelectionRange(0, text.length);\r\n            return document.execCommand(\"cut\");\r\n        }\r\n        catch (err) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a fake textarea element, sets its value from `text` property,\r\n     * and makes a selection on it.\r\n     */\r\n    initSelectFake() {\r\n        const isRTL = document.documentElement.getAttribute('dir') == 'rtl';\r\n\r\n        this.fakeElem = document.createElement('textarea');\r\n        // Prevent zooming on iOS\r\n        this.fakeElem.style.fontSize = '12pt';\r\n        // Reset box model\r\n        this.fakeElem.style.border = '0';\r\n        this.fakeElem.style.padding = '0';\r\n        this.fakeElem.style.margin = '0';\r\n        // Move element out of screen horizontally\r\n        this.fakeElem.style.position = 'absolute';\r\n        this.fakeElem.style[ isRTL ? 'right' : 'left' ] = '-9999px';\r\n        // Move element to the same position vertically\r\n        let yPosition = window.pageYOffset || document.documentElement.scrollTop;\r\n        this.fakeElem.style.top = `${yPosition}px`;\r\n\r\n        this.container.appendChild(this.fakeElem);\r\n    }\r\n\r\n    /**\r\n     * Can only be called when the combination is pressed Ctrl + V\r\n     * @returns {string}\r\n     */\r\n    paste (callback) {\r\n        this.fakeElem.value = \"\";\r\n        this.fakeElem.focus();\r\n        let onInput = (e) => {\r\n            this._text = e.target.value;\r\n            this.fakeElem.blur();\r\n            off(this.fakeElem, \"input\", onInput);\r\n            callback(this._text);\r\n        };\r\n        on(this.fakeElem, \"input\", onInput);\r\n    }\r\n\r\n    get text () {\r\n        return this._text;\r\n    }\r\n\r\n    destroy() {\r\n        if (this.fakeElem) {\r\n            this.container.removeChild(this.fakeElem);\r\n            this.fakeElem = null;\r\n        }\r\n    }\r\n}","/**\n * SheetClip - Spreadsheet Clipboard Parser\n * version 0.2\n *\n * This tiny library transforms JavaScript arrays to strings that are pasteable by LibreOffice, OpenOffice,\n * Google Docs and Microsoft Excel.\n *\n * Copyright 2012, Marcin Warpechowski\n * Licensed under the MIT license.\n * http://github.com/warpech/sheetclip/\n */\n/**\n * js-table-cell-selector\n * jslint white: true\n * to ES6 module\n */\n\nfunction countQuotes(str) {\n    return str.split('\"').length - 1;\n}\n\nexport const SheetClip = {\n    parse: function (str) {\n        var r, rlen, rows, arr = [], a = 0, c, clen, multiline, last;\n        rows = str.split('\\n');\n        if (rows.length > 1 && rows[rows.length - 1] === '') {\n            rows.pop();\n        }\n        for (r = 0, rlen = rows.length; r < rlen; r += 1) {\n            rows[r] = rows[r].split('\\t');\n            for (c = 0, clen = rows[r].length; c < clen; c += 1) {\n                if (!arr[a]) {\n                    arr[a] = [];\n                }\n                if (multiline && c === 0) {\n                    last = arr[a].length - 1;\n                    arr[a][last] = arr[a][last] + '\\n' + rows[r][0];\n                    if (multiline && (countQuotes(rows[r][0]) & 1)) { //& 1 is a bitwise way of performing mod 2\n                        multiline = false;\n                        arr[a][last] = arr[a][last].substring(0, arr[a][last].length - 1).replace(/\"\"/g, '\"');\n                    }\n                }\n                else {\n                    if (c === clen - 1 && rows[r][c].indexOf('\"') === 0 && (countQuotes(rows[r][c]) & 1)) {\n                        arr[a].push(rows[r][c].substring(1).replace(/\"\"/g, '\"'));\n                        multiline = true;\n                    }\n                    else {\n                        arr[a].push(rows[r][c].replace(/\"\"/g, '\"'));\n                        multiline = false;\n                    }\n                }\n            }\n            if (!multiline) {\n                a += 1;\n            }\n        }\n        return arr;\n    },\n\n    stringify: function (arr) {\n        var r, rlen, c, clen, str = '', val;\n        for (r = 0, rlen = arr.length; r < rlen; r += 1) {\n            for (c = 0, clen = arr[r].length; c < clen; c += 1) {\n                if (c > 0) {\n                    str += '\\t';\n                }\n                val = arr[r][c];\n                if (typeof val === 'string') {\n                    if (val.indexOf('\\n') > -1) {\n                        str += '\"' + val.replace(/\"/g, '\"\"') + '\"';\n                    }\n                    else {\n                        str += val;\n                    }\n                }\n                else if (val === null || val === void 0) { //void 0 resolves to undefined\n                    str += '';\n                }\n                else {\n                    str += val;\n                }\n            }\n            str += '\\n';\n        }\n        return str;\n    }\n};","import {_gOptions} from \"./app\";\r\nimport {getElementsByTagNames} from \"./dom\";\r\n\r\nexport default class Actions {\r\n    obSelector;\r\n    table;\r\n\r\n    constructor (obSelector) {\r\n        this.obSelector = obSelector;\r\n        this.table = this.obSelector.getTable();\r\n    }\r\n\r\n    /**\r\n     * Function: copy (c1 [, c2])\r\n     * @param c1\r\n     * @param c2\r\n     * @returns {array[][]}\r\n     */\r\n    copy (c1, c2) {\r\n        if (c2 === undefined) c2 = c1;\r\n        let ar = Array(c2[0] - c1[0] + 1 ).fill().map(\r\n            () => Array(c2[1] - c1[1] + 1 )\r\n        );\r\n\r\n        this.iterateCells(c1, c2, (iy, ix, cell) => {\r\n            ar[iy-c1[0]][ix-c1[1]] = _gOptions.getCellFn(cell, [iy, ix]);\r\n        });\r\n        return ar;\r\n    }\r\n\r\n    /**\r\n     * Function: clear (c1 [, c2])\r\n     * @param c1\r\n     * @param c2\r\n     */\r\n    clear (c1, c2) {\r\n        if (c2 === undefined) c2 = c1;\r\n        this.iterateCells(c1, c2, (iy, ix, cell) => {\r\n            if (!this.obSelector.isIgnoredCell(cell)) {\r\n                _gOptions.setCellFn(cell, \"\", [iy, ix]);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Function: cut (c1 [, c2])\r\n     * @param c1\r\n     * @param c2\r\n     * @returns {array[][]}\r\n     */\r\n    cut (c1, c2) {\r\n        if (c2 === undefined) c2 = c1;\r\n        let ar = Array(c2[0] - c1[0] + 1 ).fill().map(\r\n            () => Array(c2[1] - c1[1] + 1 )\r\n        );\r\n        this.iterateCells(c1, c2, (iy, ix, cell) => {\r\n            ar[iy-c1[0]][ix-c1[1]] = _gOptions.getCellFn(cell, [iy, ix]);\r\n            if (!this.obSelector.isIgnoredCell(cell)) {\r\n                _gOptions.setCellFn(cell, \"\", [iy, ix]);\r\n            }\r\n        });\r\n        return ar;\r\n    }\r\n\r\n    iterateCells (c1, c2, callbackFn) {\r\n        const matrix = this.obSelector.sizeMatrix;\r\n        let rows = this.table.getElementsByTagName(\"tr\");\r\n        for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n            let cells = getElementsByTagNames(\"td,th\", rows[iy]);\r\n            for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                if (!(matrix[iy][ix][0] < 0) && !(matrix[iy][ix][1] < 0)) {\r\n                    callbackFn(iy, ix, cells[matrix[iy][ix][2]]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    mergeWithCell (cell, data, coord) {\r\n        let cellVal = _gOptions.getCellFn(cell, coord).trim();\r\n        if (cellVal === \"\") cellVal = data;\r\n        else if (data !== \"\") cellVal += _gOptions.mergePastingGlue + data;\r\n        _gOptions.setCellFn(cell, cellVal, coord);\r\n    }\r\n\r\n    paste (data, c1, c2) {\r\n        const matrix = this.obSelector.sizeMatrix;\r\n        const rows = this.table.getElementsByTagName(\"tr\");\r\n        const countR = this.obSelector.countRows;\r\n        const countC = this.obSelector.countCols;\r\n\r\n        let maxY = c1[0] + data.length;\r\n        if (maxY > countR) maxY = countR;\r\n        if (maxY > c2[0]) maxY = c2[0]+1;\r\n\r\n        for (let iy = c1[0]; iy < maxY; iy++) {\r\n            let maxX = c1[1] + data[iy-c1[0]].length;\r\n            if (maxX > countC) maxX = countC;\r\n            if (maxX > c2[1]) maxX = c2[1]+1;\r\n\r\n            let cellFn;\r\n            for (let ix = c1[1]; ix < maxX; ix++) {\r\n                let y = iy;\r\n                let x = ix;\r\n                if (matrix[iy][ix][1] < 0 || matrix[iy][ix][0] < 0) {\r\n                    if (matrix[iy][ix][0] < 0) y += matrix[iy][ix][0];\r\n                    if (matrix[iy][ix][1] < 0) x += matrix[iy][ix][1];\r\n                    cellFn = this.mergeWithCell;\r\n                } else {\r\n                    cellFn = _gOptions.setCellFn;\r\n                }\r\n\r\n                let cell = getElementsByTagNames(\"td,th\", rows[y])[matrix[y][x][2]];\r\n                if (!this.obSelector.isIgnoredCell(cell)) {\r\n                    cellFn(cell, data[iy - c1[0]][ix - c1[1]], [y, x]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","import {_gOptions} from \"./app\";\r\nimport {getElementsByTagNames} from \"./dom\";\r\nimport {isEmpty, addClass, hasClass, removeClass} from \"./funcs\";\r\n\r\nexport default class Selector {\r\n    _countCols = 0;\r\n    _countRows = 0;\r\n    matrix;\r\n    table;\r\n\r\n    constructor (table) {\r\n        this.table = table;\r\n        /*if (_gOptions.usingSizeMatrix) */ this.initSizeMatrix();\r\n    }\r\n\r\n    deselectCell(cell) {\r\n        removeClass(cell, _gOptions.selectClass);\r\n    }\r\n\r\n    deselectAll() {\r\n        let length = 0;\r\n        let list = getElementsByTagNames(\"td,th\", this.table);\r\n\r\n        for (let cell of list) {\r\n            if (this.isSelectedCell(cell)) {\r\n                this.deselectCell(cell);\r\n                length++;\r\n            }\r\n        }\r\n        return length;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param c - coordinate cell. Example [0, 0]\r\n     */\r\n    getCell (c) {\r\n        if (Array.isArray(c) ) {\r\n            // normalize\r\n            c[0] = parseInt(c[0]) || 0;\r\n            c[1] = parseInt(c[1]) || 0;\r\n\r\n            if (c[0] >= 0 && c[1] >= 0) {\r\n                //if (_gOptions.usingSizeMatrix) {\r\n                if (c[0] < this.countRows && c[1] < this.countCols) {\r\n                    if (this.matrix[c[0]][c[1]][0] < 0) c[0] += this.matrix[c[0]][c[1]][0];\r\n                    if (this.matrix[c[0]][c[1]][1] < 0) c[1] += this.matrix[c[0]][c[1]][1];\r\n\r\n                    let row = this.table.getElementsByTagName(\"tr\")[c[0]];\r\n                    return getElementsByTagNames(\"td,th\", row)[this.matrix[c[0]][c[1]][2]];\r\n                }\r\n                /*} else {\r\n                    let rows = this.table.getElementsByTagName(\"tr\");\r\n                    for (let iy = 0; iy < rows.length; iy++) {\r\n                        if (c[0] != iy) continue;\r\n                        let cols = rows[iy].getElementsByTagName(\"td\");\r\n                        for (let ix = 0; ix < cols.length; ix++) {\r\n                            if (c[1] != ix) continue;\r\n                            return cols[ix];\r\n                        }\r\n                    }\r\n                }*/\r\n            }\r\n            return null;\r\n        } else {\r\n            throw new Error(\"Invalid coordinate\");\r\n        }\r\n    }\r\n\r\n    get countCols () {\r\n        return this._countCols;\r\n    }\r\n\r\n    get countRows () {\r\n        return this._countRows;\r\n    }\r\n\r\n    /**\r\n     * get coords of selected cells\r\n     * @returns array [[0, 0], [1, 1]] or false\r\n     */\r\n    getSelectedRectangleCoords () {\r\n        let isSelected = false;\r\n        let c1 = Array(2);\r\n        let c2 = Array(2);\r\n\r\n        //if (_gOptions.usingSizeMatrix) {\r\n        // get extreme points\r\n        let rows = this.table.getElementsByTagName(\"tr\");\r\n        for (let iy = 0; iy < this.countRows; iy++) {\r\n            let cells = getElementsByTagNames(\"td,th\", rows[iy]);\r\n            for (let ix = 0; ix < this.countCols; ix++) {\r\n                if (\r\n                    !(this.matrix[iy][ix][0] < 0)\r\n                    && !(this.matrix[iy][ix][1] < 0)\r\n                    && this.isSelectedCell(cells[this.matrix[iy][ix][2]])\r\n                ) {\r\n                    isSelected = true;\r\n\r\n                    if (c1[0] === undefined || c1[0] > iy) c1[0] = iy;\r\n                    if (c1[1] === undefined || c1[1] > ix) c1[1] = ix;\r\n\r\n                    if (c2[0] === undefined || c2[0] < iy) c2[0] = iy;\r\n                    if (c2[1] === undefined || c2[1] < ix) c2[1] = ix;\r\n                }\r\n            }\r\n        }\r\n        /*} else {\r\n            let rows = this.table.getElementsByTagName(\"tr\");\r\n            for (let iy = 0; iy < rows.length; iy++) {\r\n                let cols = rows[iy].getElementsByTagName(\"td\");\r\n                for (let ix = 0; ix < cols.length; ix++) {\r\n                    if(this.isSelectedCell(cols[ix]))\r\n                    {\r\n                        isSelected = true;\r\n\r\n                        if (c1[0] === undefined || iy < c1[0]) c1[0] = iy;\r\n                        if (c2[0] === undefined || iy > c2[0]) c2[0] = iy;\r\n\r\n                        if (c1[1] === undefined || ix < c1[1]) c1[1] = ix;\r\n                        if (c2[1] === undefined || ix > c2[1]) c2[1] = ix;\r\n                    }\r\n                }\r\n            }\r\n        }*/\r\n        return isSelected ? [c1, c2] : false;\r\n    }\r\n\r\n    get sizeMatrix () {\r\n        return this.matrix;\r\n    }\r\n\r\n    getRectangleCoords (c1, c2) {\r\n        // magic ))\r\n        let loop = true;\r\n        while(loop) {\r\n            loop = false;\r\n\r\n            // min y\r\n            for (let iy = c1[0]; iy <= c1[0]; iy++) {\r\n                for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                    if (this.matrix[iy][ix][0] !== undefined && this.matrix[iy][ix][0] < 0) {\r\n                        c1[0] += this.matrix[iy][ix][0];\r\n                        iy += this.matrix[iy][ix][0] - 1;\r\n                        loop = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // max y\r\n            for (let iy = c2[0]; iy <= c2[0]; iy++) {\r\n                if ((c2[0] + 1) == this.countRows ) continue;\r\n                for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                    if (this.matrix[iy][ix][0] !== undefined && this.matrix[iy + 1][ix][0] < 0) {\r\n                        c2[0]++;\r\n                        loop = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // min x\r\n            for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n                if (this.matrix[iy][c1[1]][1] < 0) {\r\n                    c1[1] += this.matrix[iy][c1[1]][1];\r\n                    iy = c1[0] - 1;\r\n                    loop = true;\r\n                    // break;\r\n                }\r\n            }\r\n\r\n            // max x\r\n            for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n                if ((c2[1] + 1) == this.countCols) continue;\r\n                if (this.matrix[iy][c2[1]+1][1] < 0) {\r\n                    c2[1]++;\r\n                    iy = c1[0] - 1;\r\n                    loop = true;\r\n                    // break;\r\n                }\r\n            }\r\n        }\r\n        return [c1, c2];\r\n    }\r\n\r\n    getTable () {\r\n        return this.table;\r\n    }\r\n\r\n    initSizeMatrix () {\r\n        let rows = this.table.getElementsByTagName(\"tr\");\r\n        this._countRows = rows.length;\r\n        this._countCols = 0;\r\n\r\n        for (let row of rows) {\r\n            let length = getElementsByTagNames(\"td, th\", row).length;\r\n            if (length > this.countCols) {\r\n                this._countCols = length;\r\n            }\r\n        }\r\n\r\n        this.matrix = Array(this.countRows).fill().map(\r\n            () => Array(this.countCols).fill().map(\r\n                () => Array(2)\r\n            )\r\n        );\r\n        let rowCrest = new Array(this.countCols).fill(0);\r\n\r\n        let iy = 0;\r\n        for (let row of rows) {\r\n            let ix = 0;\r\n            let cells = getElementsByTagNames(\"td, th\", row);\r\n            const crestFn = () => {\r\n                while (ix < this.countCols && rowCrest[ix]) {\r\n                    rowCrest[ix]--;\r\n                    this.matrix[iy][ix][0] = this.matrix[iy-1][ix][0] || 0 - 1;\r\n                    this.matrix[iy][ix][1] = this.matrix[iy-1][ix][1];\r\n                    ix++;\r\n                }\r\n            };\r\n\r\n            for (let itd = 0; itd < cells.length; itd++) {\r\n                const cell = cells[itd];\r\n                let colspan = cell.getAttribute(\"colspan\");\r\n                let rowspan = cell.getAttribute(\"rowspan\");\r\n                if (rowspan > 1) this.matrix[iy][ix][0] = 0;\r\n                if (colspan > 1) this.matrix[iy][ix][1] = 0;\r\n\r\n                crestFn();\r\n\r\n                if (colspan > 1) {\r\n                    this.matrix[iy][ix][2] = itd;\r\n                    for (let i = 0; i > -colspan; i--) {\r\n                        this.matrix[iy][ix][1] = i;\r\n                        if (rowspan > 1) rowCrest[ix] = rowspan - 1;\r\n                        ix++;\r\n                    }\r\n                } else {\r\n                    this.matrix[iy][ix][2] = itd;\r\n                    if (rowspan > 1) rowCrest[ix] = rowspan - 1;\r\n                    ix++;\r\n                }\r\n            }\r\n\r\n            crestFn();\r\n            iy++;\r\n        }\r\n    }\r\n\r\n    isIgnoredCell(cell) {\r\n        return hasClass(cell, _gOptions.ignoreClass) // td\r\n            || hasClass(cell.parentNode, _gOptions.ignoreClass) // tr\r\n            || hasClass(cell.parentNode.parentNode, _gOptions.ignoreClass); // example thead or tfoot\r\n    }\r\n\r\n    isSelectedCell(cell) {\r\n        return hasClass(cell, _gOptions.selectClass);\r\n    }\r\n\r\n    normalizeCoords (c1, c2) {\r\n        // normalize\r\n        c1[0] = parseInt(c1[0]) || 0;\r\n        c1[1] = parseInt(c1[1]) || 0;\r\n        c2[0] = parseInt(c2[0]) || 0;\r\n        c2[1] = parseInt(c2[1]) || 0;\r\n        let temp;\r\n        if (c1[0] > c2[0]) {\r\n            temp = c2[0];\r\n            c2[0] = c1[0];\r\n            c1[0] = temp;\r\n        }\r\n        if (c1[1] > c2[1]) {\r\n            temp = c2[1];\r\n            c2[1] = c1[1];\r\n            c1[1] = temp;\r\n        }\r\n        return [c1, c2];\r\n    }\r\n\r\n    /**\r\n     * select cells. Fn: select (c1 [, c2])\r\n     * @param c1 - starting position [0, 0]\r\n     * @param c2 - end position [1, 1]\r\n     * @returns {boolean}\r\n     */\r\n    select (c1, c2)\r\n    {\r\n        if (Array.isArray(c1) && (Array.isArray(c2) || c2 === undefined)) {\r\n\r\n            if (c2 === undefined || (c1[0] == c2[0] && c1[1] == c2[1])) {\r\n                // normalize\r\n                let cell = this.getCell(c1);\r\n                if (!isEmpty(cell)) {\r\n                    return this.selectCell(cell);\r\n                }\r\n            } else {\r\n                let isSelected = false;\r\n                [c1, c2] = this.normalizeCoords(c1, c2);\r\n\r\n                //if (_gOptions.usingSizeMatrix) {\r\n                if (c1[0] >= this.countRows || c1[1] >= this.countCols || c2[0] < 0 || c2[1] < 0) return false;\r\n                if (c1[0] < 0) c1[0] = 0;\r\n                if (c1[1] < 0) c1[1] = 0;\r\n                if (c2[0] >= this.countRows) c2[0] = this.countRows - 1;\r\n                if (c2[1] >= this.countCols) c2[1] = this.countCols - 1;\r\n\r\n                [c1, c2] = this.getRectangleCoords(c1, c2);\r\n\r\n                let rows = this.table.getElementsByTagName(\"tr\");\r\n                for (let iy = c1[0]; iy <= c2[0]; iy++) {\r\n                    let cells = getElementsByTagNames(\"td, th\", rows[iy]);\r\n                    for (let ix = c1[1]; ix <= c2[1]; ix++) {\r\n                        if (!(this.matrix[iy][ix][0] < 0) && !(this.matrix[iy][ix][1] < 0)) {\r\n                            let result = this.selectCell(cells[this.matrix[iy][ix][2]]);\r\n                            if (!isSelected) isSelected = result;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                /*} else {\r\n\r\n                    let rows = this.table.getElementsByTagName(\"tr\");\r\n                    for (let iy = 0; iy < rows.length; iy++) {\r\n                        if (iy < c1[0] || iy > c2[0]) continue;\r\n                        let cols = rows[iy].getElementsByTagName(\"td\");\r\n                        for (let ix = 0; ix < cols.length; ix++) {\r\n                            if (ix < c1[1] || ix > c2[1]) continue;\r\n                            let result = this.selectCell(cols[ix]);\r\n                            if (!isSelected) isSelected = result;\r\n                        }\r\n                    }\r\n                }*/\r\n                return isSelected;\r\n            }\r\n\r\n            return false;\r\n        } else {\r\n            throw new Error(\"Invalid selection positions\");\r\n        }\r\n    }\r\n\r\n    selectAll () {\r\n        let length = 0;\r\n        let list = getElementsByTagNames(\"td, th\", this.table);\r\n        for (let cell of list) {\r\n            if (this.selectCell(cell)) {\r\n                length++;\r\n            }\r\n        }\r\n        return length;\r\n    }\r\n\r\n    selectCell(cell) {\r\n        if (_gOptions.selectIgnoreClass || !this.isIgnoredCell(cell)) {\r\n            addClass(cell, _gOptions.selectClass);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}","import {_gOptions} from \"./app\";\r\nimport {getParentTags, isElement, on, off} from \"./dom\";\r\nimport {addClass, removeClass} from \"./funcs\";\r\n\r\nexport default class Table {\r\n    isMouseDown = false; // whether the left mouse button is pressed\r\n    obApp;\r\n    obSelector;\r\n    observer;\r\n    table; // html table\r\n    _isMouse = false;\r\n    _onMouseOver = (e) => this.onMouseOver(e);\r\n    _onMouseDown = (e) => this.onMouseDown(e);\r\n    _onMouseEnter = (e) => this.onMouseEnter(e);\r\n    _onMouseLeave = (e) => this.onMouseLeave(e);\r\n    _onMouseUp = (e) => this.onMouseUp(e);\r\n    _onOutTableClick = (e) => this.onOutTableClick(e);\r\n\r\n    constructor(table, obSelector, obApp) {\r\n        if (isElement(table) && table.tagName === \"TABLE\") {\r\n            this.table = table; // DOM element table\r\n            this.obApp = obApp;\r\n            this.obSelector = obSelector;\r\n            addClass(this.table, _gOptions.selectableTableClass);\r\n            this.addEvents();\r\n            if (_gOptions.changeTracking) this.initObserver();\r\n        } else {\r\n            throw new Error(\"odule must be initialized to Table\");\r\n        }\r\n    }\r\n\r\n    addEvents() {\r\n        on(this.table, \"mouseover\", this._onMouseOver);\r\n        on(this.table, \"mousedown\", this._onMouseDown);\r\n        on(this.table, \"mouseenter\", this._onMouseEnter);\r\n        on(this.table, \"mouseleave\", this._onMouseLeave);\r\n        on(this.table, \"mouseup\", this._onMouseUp);\r\n        on(this.table.ownerDocument, \"click\", this._onOutTableClick); // click outside the table\r\n    }\r\n\r\n    /**\r\n     * Tracking changes in the structure of the table (delete or add rows of columns) for re-initializing of size matrix\r\n     */\r\n    initObserver() {\r\n        const _Observer = MutationObserver || window.WebKitMutationObserver;\r\n        if (!_Observer) return false;\r\n        this.observer = new _Observer((mutations) => {\r\n            mutations.forEach((e) => {\r\n                if ([\"TABLE\", \"THEAD\", \"TBODY\", \"TFOOT\", \"TR\"].indexOf(e.target.tagName) > -1) {\r\n                    this.obSelector.initSizeMatrix();\r\n                }\r\n            });\r\n        });\r\n        this.observer.observe(this.table, { childList: true, subtree: true });\r\n        return true;\r\n    }\r\n\r\n    get isMouse () {\r\n        return this._isMouse;\r\n    }\r\n\r\n    isRightMouseBtn(e) {\r\n        let isRightMB;\r\n        e = e || window.event;\r\n\r\n        if (\"which\" in e)  // Gecko (Firefox), WebKit (Safari/Chrome) & Opera\r\n            isRightMB = e.which == 3;\r\n        else if (\"button\" in e)  // IE, Opera\r\n            isRightMB = e.button == 2;\r\n\r\n        return isRightMB;\r\n    }\r\n\r\n    onMouseDown(e) {\r\n        e.preventDefault();\r\n        if (this.isRightMouseBtn(e)) return true;\r\n\r\n        let cell = getParentTags(e.target, \"td,th\");\r\n        if (cell === null) return; // not for cell\r\n\r\n        this.isMouseDown = true;\r\n\r\n        this.obSelector.deselectAll();\r\n        this.obSelector.selectCell(cell);\r\n    }\r\n\r\n    onMouseOver(e) {\r\n        if (!this.isMouseDown) return false;\r\n\r\n        let cell = getParentTags(e.target, \"td,th\");\r\n        if (cell === null) return; // not for cell\r\n\r\n        this.obSelector.selectCell(cell);\r\n        //magic selection\r\n        let coords = this.obSelector.getSelectedRectangleCoords();\r\n        if (coords !== false) this.obSelector.select(coords[0], coords[1]);\r\n    }\r\n\r\n    onMouseEnter (e) {\r\n        this._isMouse = true;\r\n    }\r\n\r\n    onMouseLeave (e) {\r\n        this._isMouse = false;\r\n    }\r\n\r\n    onMouseUp(e) {\r\n        this.isMouseDown = false;\r\n    }\r\n\r\n    onOutTableClick(e) {\r\n        this.isMouseDown = false;\r\n        if (_gOptions.deselectOutTableClick && !this.isMouse) {\r\n            this.obSelector.deselectAll();\r\n        }\r\n    }\r\n\r\n    removeEvents() {\r\n        off(this.table, \"mouseover\", this._onMouseOver);\r\n        off(this.table, \"mousedown\", this._onMouseDown);\r\n        off(this.table, \"mouseenter\", this._onMouseEnter);\r\n        off(this.table, \"mouseleave\", this._onMouseLeave);\r\n        off(this.table, \"mouseup\", this._onMouseUp);\r\n        off(this.table.ownerDocument, \"click\", this._onOutTableClick);\r\n    }\r\n\r\n    destroy() {\r\n        if (this.observer) this.observer.disconnect();\r\n        removeClass(this.table, _gOptions.selectableTableClass);\r\n        this.removeEvents();\r\n    }\r\n}","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}